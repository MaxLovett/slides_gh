<!DOCTYPE html>
<html lang="en"><head>
<script src="03_latentVariableI_files/libs/clipboard/clipboard.min.js"></script>
<script src="03_latentVariableI_files/libs/quarto-html/tabby.min.js"></script>
<script src="03_latentVariableI_files/libs/quarto-html/popper.min.js"></script>
<script src="03_latentVariableI_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="03_latentVariableI_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="03_latentVariableI_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="03_latentVariableI_files/libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="03_latentVariableI_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="03_latentVariableI_files/libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="03_latentVariableI_files/libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="03_latentVariableI_files/libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.4.533">

  <meta name="author" content="胡悦">
  <title>潜变量分析（基础篇）</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="03_latentVariableI_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="03_latentVariableI_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
  </style>
  <link rel="stylesheet" href="03_latentVariableI_files/libs/revealjs/dist/theme/quarto.css">
  <link rel="stylesheet" href="https://www.drhuyue.site/slides_gh/css/style_basic.css">
  <link href="03_latentVariableI_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="03_latentVariableI_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="03_latentVariableI_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="03_latentVariableI_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    padding-bottom: 0.5rem;
    margin-bottom: 0;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" data-background-image="https://gitlab.com/sammo3182/backup/raw/85b3c1ad4b459d7a9f901f124b936428eda5fcaf/logo_THPS.png?inline=true" data-background-position="top 10% right 5%" data-background-size="250px" class="quarto-title-block center">
  <h1 class="title">潜变量分析（基础篇）</h1>
  <p class="subtitle">政务大数据应用与分析 (80700673)</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
胡悦 
</div>
        <p class="quarto-title-affiliation">
            清华大学
          </p>
    </div>
</div>

</section>
<section id="概要" class="slide level2">
<h2>概要</h2>
<div class="columns">
<div class="column" style="width:50%;">
<ol type="1">
<li class="fragment">概念与分析逻辑
<ul>
<li class="fragment">什么是潜变量</li>
<li class="fragment">怎么分析</li>
</ul></li>
<li class="fragment">探索性因子分析</li>
<li class="fragment">验证性因子分析（与结构方程模型）</li>
</ol>
</div><div class="column fragment" style="width:50%;">
<p><strong>操作语言</strong></p>
<ul>
<li>R
<ul>
<li><a href="https://personality-project.org/r/psych/vignettes/intro.pdf"><code>psych</code></a></li>
<li><a href="https://lavaan.ugent.be/"><code>laavan</code></a></li>
</ul></li>
</ul>
</div>
</div>
</section>
<section>
<section id="潜变量概念与分析逻辑" class="title-slide slide level1 center">
<h1>潜变量概念与分析逻辑</h1>

</section>
<section id="潜在变量-latent-variables" class="slide level2">
<h2>潜在变量 (Latent variables)</h2>
<div class="r-hstack">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><a href="https://drhuyue.site:10002/sammo3182/figure/lv_angry.jpg" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img data-src="https://drhuyue.site:10002/sammo3182/figure/lv_angry.jpg" class="quarto-figure quarto-figure-center" height="600"></a></p>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><a href="https://drhuyue.site:10002/sammo3182/figure/lv_happy.jpg" class="lightbox" data-gallery="quarto-lightbox-gallery-2"><img data-src="https://drhuyue.site:10002/sammo3182/figure/lv_happy.jpg" class="fragment quarto-figure quarto-figure-center" height="600"></a></p>
</figure>
</div>
</div>
</section>
<section id="why-bother" class="slide level2">
<h2>Why bother</h2>
<div class="r-stack">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><a href="https://drhuyue.site:10002/sammo3182/figure/lv_liberty.jpg" class="lightbox" data-glightbox="description: .lightbox-desc-3" data-gallery="quarto-lightbox-gallery-3" title="Liberty leading the people"><img data-src="https://drhuyue.site:10002/sammo3182/figure/lv_liberty.jpg" class="quarto-figure quarto-figure-center" height="600" alt="Liberty leading the people"></a></p>
<figcaption>Liberty leading the people</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><a href="https://drhuyue.site:10002/sammo3182/figure/lv_patriotism.webp" class="lightbox" data-glightbox="description: .lightbox-desc-4" data-gallery="quarto-lightbox-gallery-4" title="战狼II"><img data-src="https://drhuyue.site:10002/sammo3182/figure/lv_patriotism.webp" class="fragment quarto-figure quarto-figure-center" height="600" alt="战狼II"></a></p>
<figcaption>战狼II</figcaption>
</figure>
</div>
</div>
</section>
<section class="slide level2">

<blockquote>
<p>Latent variable analysis is the <span class="red">cornerstone</span> of successful scientific inquiry.<sup>1</sup></p>
</blockquote>
<div class="columns">
<div class="column" style="width:30%;">
<p>涵盖所有社会科学学科</p>
<ul>
<li class="fragment">抽象</li>
<li class="fragment">复杂</li>
<li class="fragment">综合</li>
</ul>
</div><div class="column fragment" style="width:30%;">
<p>学科性挑战</p>
<ol type="1">
<li class="fragment">不可见(Unobservable)</li>
<li class="fragment">多维度(Multidimensional)</li>
<li class="fragment">有效果(Consequential)</li>
</ol>
<aside class="notes">
<p>兜里有多少钱，不可见，但维度单一，不宜用潜变量分析，更好的办法是翻兜</p>
<p>The latent variable per se can’t be directly measured. But its consequences in opinions and behaviors can be observed.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</div><div class="column" style="width:40%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><a href="https://drhuyue.site:10002/sammo3182/figure/lv_jamesStimson.jpg" class="lightbox" data-gallery="quarto-lightbox-gallery-5"><img data-src="https://drhuyue.site:10002/sammo3182/figure/lv_jamesStimson.jpg" class="fragment quarto-figure quarto-figure-center" height="400"></a></p>
</figure>
</div>
<aside class="notes">
<p>Jaes Stimson (1991), University of North Carolina at Chapel Hill</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</div>
</div>
<aside><ol class="aside-footnotes"><li id="fn1"><p>Delli Carpini, M. X., and S. Keeter. 1993. “Measuring Political Knowledge: Putting First Things First.” <em>American Journal of Political Science</em> 37 (4): 1179–1206.</p></li></ol></aside></section>
<section id="分析逻辑" class="slide level2">
<h2>分析逻辑：</h2>
<div style="text-align:center; margin-top: 2em">
<p>结果 <span class="red">←</span> 共因</p>
</div>
<div class="fragment">
<p>🌰 个体的社会资本（social capital）</p>
</div>
<aside class="notes">
<p>Three dimensions of social capital:</p>
<ol type="1">
<li>Trust</li>
<li>Norms</li>
<li>Networks</li>
</ol>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
<div class="fragment" style="text-align:center; margin-top: 2em">
<p>指标问题（1~10）：</p>
<ol type="1">
<li>您是否信任身边人？</li>
<li>您在政府机关有没有亲戚？</li>
<li>您的朋友是否和您的想法经常一致？</li>
</ol>
</div>
</section>
<section id="测量社会资本" class="slide level2">
<h2>测量社会资本</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p>累加综合法(additive scales)</p>
<p><span class="math display">\[\tilde{X} = (X_1 + X_2 + X_3)/3.\]</span></p>
</div><div class="column fragment" style="width:50%;">
<p><em>潜在问题</em></p>
<ol type="1">
<li class="fragment">平等权重(equal weight)</li>
<li class="fragment">数据敏感(extreme value sensitivity)</li>
<li class="fragment">忽略极化(polarity ignoring)</li>
</ol>
</div>
</div>
<div class="fragment large" style="text-align:center; margin-top: 2em">
<p><em>如何做得更好？</em></p>
</div>
</section>
<section id="因子分析基本模型" class="slide level2">
<h2>因子分析基本模型</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p><strong>因素分析模型(Factorial Models)</strong></p>
<ol type="1">
<li class="fragment">探索性因子分析(EFA)</li>
<li class="fragment">验证性因子分析(CFA)</li>
<li class="fragment">结构方程模型(SEM)</li>
</ol>
</div><div class="column" style="width:50%;">
<p><strong>类型分析模型(Topological Models)</strong></p>
<ol type="1">
<li class="fragment">项目反应理论(IRT)</li>
<li class="fragment">MRP</li>
<li class="fragment">跨群组项目反应(GIRT, DCPO)</li>
</ol>
</div>
</div>
</section></section>
<section>
<section id="因子分析" class="title-slide slide level1 center">
<h1>因子分析</h1>

</section>
<section id="基本原理" class="slide level2">
<h2>基本原理</h2>
<div style="text-align:center">
<p>结果 <span class="red">←</span> 共因</p>
<p>⇑</p>
<p>可见指标(indicators) <span class="red">←</span> 潜在变量</p>
</div>
<div class="fragment" style="text-align:center">
<p>⇑</p>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><a href="https://drhuyue.site:10002/sammo3182/figure/lv_jiangwei.jpg" class="lightbox" data-glightbox="description: .lightbox-desc-6" data-gallery="quarto-lightbox-gallery-6" title="Minimum factors for the variances"><img data-src="https://drhuyue.site:10002/sammo3182/figure/lv_jiangwei.jpg" class="quarto-figure quarto-figure-center" height="300" alt="Minimum factors for the variances"></a></p>
<figcaption>Minimum factors for the variances</figcaption>
</figure>
</div>
</div>
<aside class="notes">
<p>determine the minimum number of hypothetical factors or components that account for the variance between variables.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="操作挑战" class="slide level2">
<h2>操作挑战</h2>
<div class="columns">
<div class="column" style="width:60%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><a href="https://drhuyue.site:10002/sammo3182/figure/lv_efa.png" class="lightbox" data-gallery="quarto-lightbox-gallery-7"><img data-src="https://drhuyue.site:10002/sammo3182/figure/lv_efa.png" class="quarto-figure quarto-figure-center" height="600"></a></p>
</figure>
</div>
</div><div class="column" style="width:40%;">
<ul>
<li class="fragment"><strong>目标</strong>
<ul>
<li class="fragment">I wanna fewer dimensons</li>
</ul></li>
<li class="fragment"><strong>挑战</strong>:
<ul>
<li class="fragment">降到几维
<ul>
<li class="fragment">一维是是不是最优选择</li>
</ul></li>
<li class="fragment">如何降维
<ul>
<li class="fragment">如何克服“累加综合法”缺陷</li>
</ul></li>
</ul></li>
</ul>
<div class="fragment r-fit-text">
<p><em>Exploratory</em> FA</p>
</div>
</div>
</div>
</section>
<section id="探索式因子分析" class="slide level2">
<h2>探索式因子分析</h2>
<div class="callout callout-important callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>根本公式</strong></p>
</div>
<div class="callout-content">
<p><span class="math display">\[X^* = \Phi\Lambda' + \epsilon,\]</span></p>
<div style="text-align:center">
<p><strong><span class="math inline">\(X^*\)</span></strong>: 潜在变量<br>
<strong>Φ</strong>: 指标选择<br>
<strong>Λ</strong>: 单项贡献（a.k.a., factor loading）<br>
<strong>ε</strong> 选择误差</p>
</div>
</div>
</div>
</div>
<aside class="notes">
<p>Quinn, Kevin M. undefined/ed.&nbsp;“Bayesian Factor Analysis for Mixed Ordinal and Continuous Responses.” Political Analysis 12(4): 338–53.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
<div class="fragment" style="text-align:center">
<p><em>操作步骤</em></p>
<ol type="1">
<li>因子个数选择</li>
<li>因子提取</li>
<li>Rotation</li>
<li>因子合成</li>
<li>结果检验</li>
</ol>
</div>
</section>
<section id="人格测试" class="slide level2">
<h2>🌰：人格测试</h2>
<p>19,719 参与者, Big5 personality</p>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><a href="https://drhuyue.site:10002/sammo3182/figure/lv_big5.jpg" class="lightbox" data-gallery="quarto-lightbox-gallery-8"><img data-src="https://drhuyue.site:10002/sammo3182/figure/lv_big5.jpg" class="quarto-figure quarto-figure-center" height="400"></a></p>
</figure>
</div>
</section>
<section id="实证数据" class="slide level2">
<h2>实证数据</h2>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 19,719 × 57
    race   age engnat gender  hand source country    E1    E2    E3    E4    E5    E6
   &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1     3    53      1      1     1      1 US          4     2     5     2     5     1
 2    13    46      1      2     1      1 US          2     2     3     3     3     3
 3     1    14      2      2     1      1 PK          5     1     1     4     5     1
 4     3    19      2      2     1      1 RO          2     5     2     4     3     4
 5    11    25      2      2     1      2 US          3     1     3     3     3     1
 6    13    31      1      2     1      2 US          1     5     2     4     1     3
 7     5    20      1      2     1      5 US          5     1     5     1     5     1
 8     4    23      2      1     1      2 IN          4     3     5     3     5     1
 9     5    39      1      2     3      4 US          3     1     5     1     5     1
10     3    18      1      2     1      5 US          1     4     2     5     2     4
# ℹ 19,709 more rows
# ℹ 44 more variables: E7 &lt;dbl&gt;, E8 &lt;dbl&gt;, E9 &lt;dbl&gt;, E10 &lt;dbl&gt;, N1 &lt;dbl&gt;, N2 &lt;dbl&gt;,
#   N3 &lt;dbl&gt;, N4 &lt;dbl&gt;, N5 &lt;dbl&gt;, N6 &lt;dbl&gt;, N7 &lt;dbl&gt;, N8 &lt;dbl&gt;, N9 &lt;dbl&gt;, N10 &lt;dbl&gt;,
#   A1 &lt;dbl&gt;, A2 &lt;dbl&gt;, A3 &lt;dbl&gt;, A4 &lt;dbl&gt;, A5 &lt;dbl&gt;, A6 &lt;dbl&gt;, A7 &lt;dbl&gt;, A8 &lt;dbl&gt;,
#   A9 &lt;dbl&gt;, A10 &lt;dbl&gt;, C1 &lt;dbl&gt;, C2 &lt;dbl&gt;, C3 &lt;dbl&gt;, C4 &lt;dbl&gt;, C5 &lt;dbl&gt;, C6 &lt;dbl&gt;,
#   C7 &lt;dbl&gt;, C8 &lt;dbl&gt;, C9 &lt;dbl&gt;, C10 &lt;dbl&gt;, O1 &lt;dbl&gt;, O2 &lt;dbl&gt;, O3 &lt;dbl&gt;, O4 &lt;dbl&gt;,
#   O5 &lt;dbl&gt;, O6 &lt;dbl&gt;, O7 &lt;dbl&gt;, O8 &lt;dbl&gt;, O9 &lt;dbl&gt;, O10 &lt;dbl&gt;</code></pre>
</div>
</div>
<aside class="notes">
<p>经验开放性Openness, 尽责性Conscientiousness, 外向型Extraversion, 亲和性Agreeableness, 情绪不稳定型Neuroticism</p>
<p>https://quantdev.ssri.psu.edu/tutorials/intro-basic-exploratory-factor-analysis</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
<div class="fragment" style="text-align:center">
<p><em>挑战（again）</em></p>
<ul>
<li>降到几维</li>
<li>如何降维</li>
</ul>
</div>
</section>
<section id="维度选择方法相关性分析" class="slide level2">
<h2>维度选择方法：相关性分析</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><a href="03_latentVariableI_files/figure-revealjs/corrplot-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-9"><img data-src="03_latentVariableI_files/figure-revealjs/corrplot-1.png" class="quarto-figure quarto-figure-center" width="960"></a></p>
</figure>
</div>
</div>
</div>
</section>
<section id="维度选择方法horns-parallel-analysis" class="slide level2">
<h2>维度选择方法：Horn’s Parallel Analysis</h2>
<div class="columns">
<div class="column" style="width:70%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><a href="03_latentVariableI_files/figure-revealjs/parallelAnalysis-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-10"><img data-src="03_latentVariableI_files/figure-revealjs/parallelAnalysis-1.png" class="quarto-figure quarto-figure-center" width="960"></a></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:30%;">
<p>已知观测数据集<strong>O</strong><sub>m×n</sub></p>
<ol type="1">
<li class="fragment">创建随机数据集<strong>R</strong><sub>m×n</sub>;<br>
</li>
<li class="fragment">相关矩阵<sub><strong>R</strong></sub> → λ<sub><strong>R</strong></sub>;<br>
</li>
<li class="fragment">相关矩阵<sub><strong>Ok</strong></sub> → λ<sub><strong>Ok</strong></sub> (k为因子数)</li>
<li class="fragment">λ<sub><strong>Ok</strong></sub> vs.&nbsp;λ<sub><strong>R</strong></sub></li>
</ol>
<div class="fragment">
<p>A. 如果λ<sub><strong>Ok</strong></sub> &lt; λ<sub><strong>R</strong></sub>, 则 <del>k</del> B. Kaiser criterion</p>
</div>
</div>
</div>
</section>
<section id="因子提取factor-extraction" class="slide level2">
<h2>因子提取(Factor Extraction)</h2>
<div>
<ul>
<li>Minimum residual (OLS)</li>
<li>Principal axes</li>
<li>Alpha factoring</li>
<li>Weighted least squares</li>
<li>Minimum rank</li>
<li><span class="red">Maximum likelihood (ML, minimum χ<sup>2</sup> goodness of fit)</span></li>
</ul>
</div>
</section>
<section id="rotation-效果优化" class="slide level2">
<h2>Rotation: 效果优化</h2>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><a href="https://drhuyue.site:10002/sammo3182/figure/lv_rotation.jpg" class="lightbox" data-gallery="quarto-lightbox-gallery-11"><img data-src="https://drhuyue.site:10002/sammo3182/figure/lv_rotation.jpg" class="quarto-figure quarto-figure-center" height="400"></a></p>
</figure>
</div>
<aside class="notes">
<p>Rotation:</p>
<p>A pattern of loadings where each item loads strongly on only one of the factors, and much more weakly on the other factors.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
<ul>
<li class="fragment">Orthogonal: Varimax, quartimax, bentlerT, geominT, bifactor<br>
</li>
<li class="fragment"><span class="red">Oblique</span>: Oblimin, quartimin, simplimax, bentlerQ, geominQ, biquartimin</li>
</ul>
<aside class="notes">
<p>Orthogonal(正交)</p>
<p>优选Oblique，允许factor间correlate</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="合成结果" class="slide level2">
<h2>合成结果</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p>ML + Oblimin</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Loadings:
    ML1    ML2    ML3    ML5    ML4   
E1   0.691                            
E2  -0.697                            
E3   0.640                            
E4  -0.717                            
E5   0.732                            
E6  -0.547                            
E7   0.749                            
E8  -0.582                            
E9   0.623                            
E10 -0.662                            
N1          0.671                     
N2         -0.497                     
N3          0.593                     
N4                                    
N5          0.537                     
N6          0.746                     
N7          0.733                     
N8          0.760                     
N9          0.731                     
N10         0.576                     
A1                -0.432              
A2                 0.496              
A3                -0.404              
A4                 0.808              
A5                -0.652              
A6                 0.615              
A7                -0.582              
A8                 0.571              
A9                 0.713              
A10                0.334              
C1                        0.598       
C2                       -0.544       
C3                        0.395       
C4                       -0.531       
C5                        0.633       
C6                       -0.587       
C7                        0.555       
C8                       -0.454       
C9                        0.640       
C10                       0.466       
O1                               0.582
O2                              -0.537
O3                               0.538
O4                              -0.463
O5                               0.607
O6                              -0.502
O7                               0.492
O8                               0.552
O9                               0.346
O10                              0.679

                 ML1   ML2   ML3   ML5   ML4
SS loadings    4.912 4.409 3.601 3.174 3.163
Proportion Var 0.098 0.088 0.072 0.063 0.063
Cumulative Var 0.098 0.186 0.258 0.322 0.385</code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><a href="03_latentVariableI_files/figure-revealjs/scores-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-12"><img data-src="03_latentVariableI_files/figure-revealjs/scores-1.png" class="quarto-figure quarto-figure-center" width="960"></a></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="诊断指标" class="slide level2">
<h2>诊断指标</h2>
<ol type="1">
<li class="fragment">Sum of squared (SS) loading<sup>1</sup>: 1</li>
<li class="fragment">Communality/Uniqueness</li>
<li class="fragment">Root means square of residuals(RMSR): 0.05</li>
<li class="fragment">Tucker-Lewis Indes (TLI): 0.9</li>
<li class="fragment">Reliability test (Crobach’s α)<sup>2</sup></li>
</ol>
<aside class="notes">
<p>SS：Kaiser criterion: λ &lt; 1 不可 Communality: SS of all the factor loadings for a given variable Uniqueness: 1 - Communality RMSR &lt; 0.05 TLI &gt; 0.9</p>
<p>Crobach’s α: 计算因子分布的variables是不是内部一致，除非发表，不大必要</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
<aside><ol class="aside-footnotes"><li id="fn2"><p>特征值</p></li><li id="fn3"><p>为每个因子分别计算</p></li></ol></aside></section>
<section class="slide level2">

<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Factor analysis with Call: fa(r = ., nfactors = 5, rotate = "oblimin", fm = "ml")

Test of the hypothesis that 5 factors are sufficient.
The degrees of freedom for the model is 985  and the objective function was  3 
The number of observations was  19719  with Chi Square =  59071.56  with prob &lt;  0 

The root mean square of the residuals (RMSA) is  0.03 
The df corrected root mean square of the residuals is  0.04 

Tucker Lewis Index of factoring reliability =  0.808
RMSEA index =  0.055  and the 10 % confidence intervals are  0.054 0.055
BIC =  49330.56
 With factor correlations of 
      ML1   ML2   ML3   ML5   ML4
ML1  1.00 -0.24  0.25  0.09  0.17
ML2 -0.24  1.00 -0.03 -0.24 -0.08
ML3  0.25 -0.03  1.00  0.14  0.07
ML5  0.09 -0.24  0.14  1.00  0.05
ML4  0.17 -0.08  0.07  0.05  1.00</code></pre>
</div>
</div>
</section>
<section id="注意事项" class="slide level2">
<h2>注意事项</h2>
<ul>
<li class="fragment">EFA是<em>归纳式</em>研究方法，<span class="red">并非统计推断</span></li>
<li class="fragment">EFA应用需满足以下假定:
<ol type="1">
<li class="fragment"><span class="red"><em>Linearity</em></span> between the observed and latent</li>
<li class="fragment"><span class="red"><em>Sufficient correlation</em></span> between the observed and latent</li>
<li class="fragment"><span class="red"><em>Homoscedasticity</em></span></li>
<li class="fragment"><span class="red"><em>Multivariate normality</em></span> among the observed</li>
<li class="fragment"><span class="blue"><em>No singularity</em></span> among the observed</li>
<li class="fragment"><span class="blue"><em>Large N</em></span>: 10 ~ 300</li>
<li class="fragment"><span class="blue"><em>Factorial Simplicity</em></span></li>
</ol></li>
<li class="fragment">EFA不是唯一合理的合并方式
<ul>
<li class="fragment"><span class="gray">IRT</span></li>
<li class="fragment">PCA</li>
</ul></li>
</ul>
<aside class="notes">
<p>Red: bias; blue: efficiency</p>
<ol type="1">
<li><p><strong>Linearity</strong>: EFA assumes a linear relationship between observed variables and underlying factors. This means that changes in the levels of factors are associated with proportional changes in the observed variables.</p></li>
<li><p><strong>Multivariate Normality</strong>: Ideally, the observed variables should follow a multivariate normal distribution. While EFA can be performed on data that do not perfectly adhere to this assumption, deviations from multivariate normality can affect the robustness of the factor analysis, especially when estimating parameters and computing fit indices.</p></li>
<li><p><strong>Adequate Sample Size</strong>: There is no strict rule for the minimum sample size in EFA, but a larger sample size can provide more reliable and stable factor solutions. A commonly cited guideline suggests having at least 5 to 10 observations per variable, though some scholars recommend a minimum of 300 cases as a more general benchmark.</p></li>
<li><p><strong>No Perfect Multicollinearity or Singularity</strong>: While EFA aims to identify the underlying structure by exploring the correlations between variables, perfect multicollinearity (where one variable is a perfect linear combination of others) should be avoided. Similarly, singularity (where some variables are redundant) should be avoided, as these conditions can distort the analysis.</p></li>
<li><p><strong>Sufficient Correlation</strong>: For a factor model to be meaningful, there must be some degree of correlation among the observed variables. If variables are completely uncorrelated, there would be no underlying factors to extract. The Kaiser-Meyer-Olkin (KMO) measure of sampling adequacy and Bartlett’s test of sphericity are commonly used to assess this assumption.</p></li>
<li><p><strong>Homoscedasticity</strong>: The assumption of homoscedasticity (equal variances) among variables is also important for the generalizability of EFA results. Significant heteroscedasticity can lead to biased estimates of factor loadings and uniqueness.</p></li>
<li><p><strong>Factorial Simplicity</strong>: This is more of a desired property than a strict assumption. Factorial simplicity implies that each variable should load strongly on one factor and have minimal loadings on other factors. This assumption facilitates the interpretability of factors.</p></li>
</ol>
<p>Violations of these assumptions can lead to inaccurate factor solutions, misleading interpretations, and conclusions. It is therefore important to assess these assumptions before proceeding with EFA. In practice, some of these assumptions can be relaxed or addressed through data transformation, adopting robust estimation methods, or increasing the sample size.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="principal-component-analysis" class="slide level2">
<h2>Principal Component Analysis</h2>
<div class="callout callout-important callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>根本公式</strong></p>
</div>
<div class="callout-content">
<p><span class="math display">\[C = w_iY_i,\]</span></p>
<div style="text-align:center">
<p><strong>C</strong>: Components， “因子”</p>
<p><strong>Y</strong>: Measures</p>
</div>
</div>
</div>
</div>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><a href="https://drhuyue.site:10002/sammo3182/figure/lv_pca.png" class="lightbox" data-gallery="quarto-lightbox-gallery-13"><img data-src="https://drhuyue.site:10002/sammo3182/figure/lv_pca.png" class="quarto-figure quarto-figure-center" height="300"></a></p>
</figure>
</div>
<aside class="notes">
<p>create one or more index variables (Components) from a larger set of measured variables (Y)</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="pca-vs.-efa" class="slide level2">
<h2>PCA vs.&nbsp;EFA</h2>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><a href="https://drhuyue.site:10002/sammo3182/figure/lv_pcaVsEfa.PNG" class="lightbox" data-gallery="quarto-lightbox-gallery-14"><img data-src="https://drhuyue.site:10002/sammo3182/figure/lv_pcaVsEfa.PNG" class="quarto-figure quarto-figure-center" height="500"></a></p>
</figure>
</div>
<div class="fragment r-fit-text">
<p>结果或近似，逻辑大不同</p>
</div>
<aside class="notes">
<p>PCA: measurement to index</p>
<p>write all variables in terms of a smaller set of features which allows for a maximum amount of variance to be retained in the data.</p>
<p>EFA: indices to measurement (of a latent variable)</p>
<p>find a set of features which allow for understanding as much of the correlations between measured variables as possible. individually.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="when-to-usd-what" class="slide level2">
<h2>When to usd what</h2>
<ul>
<li class="fragment">PCA最大程度保留可见变量信息，EFA旨在提取不可变量特征；</li>
<li class="fragment">当Variable之间关系不那么紧密或受同一变量影响，PCA &gt; EFA；</li>
<li class="fragment">当估计潜在变量时，PCA可能夸大可见指标的影响</li>
</ul>
</section></section>
<section>
<section id="验证性因子分析" class="title-slide slide level1 center">
<h1>验证性因子分析</h1>

</section>
<section id="探索性-vs-验证性" class="slide level2">
<h2>探索性 vs 验证性</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p><strong>EFA: 数据指向</strong></p>
<ol type="1">
<li class="fragment">实证观察（归纳）
<ul>
<li class="fragment"><em>无法统计推断</em></li>
</ul></li>
<li class="fragment">未知维度
<ul>
<li class="fragment">每个维度都产生影响</li>
</ul></li>
<li class="fragment">多重指标
<ul>
<li class="fragment">Loading<strong>大小</strong>之分</li>
</ul></li>
<li class="fragment">无视测量偏差关联</li>
<li class="fragment">Underidentified</li>
</ol>
</div><div class="column" style="width:50%;">
<p><strong>CFA: 理论指向</strong></p>
<ol type="1">
<li class="fragment">理论定义（演绎）
<ul>
<li class="fragment"><span class="red"><em>专为统计推断</em></span></li>
</ul></li>
<li class="fragment">明确维度
<ul>
<li class="fragment">维度-指标关系明确</li>
</ul></li>
<li class="fragment">单一指标
<ul>
<li class="fragment">Loading<span class="red">有无</span>之分</li>
</ul></li>
<li class="fragment">允许测量误差相关</li>
<li class="fragment">必须identifiable</li>
</ol>
</div>
</div>
</section>
<section id="cfa指标选择" class="slide level2">
<h2>CFA指标选择</h2>
<div class="columns">
<div class="column" style="width:50%;">
<ol type="1">
<li class="fragment">严格依据理论：<del>原因</del>效果指标</li>
<li class="fragment">每维度一指标<sup>1</sup></li>
</ol>
<div class="fragment">
<p>🌰 人际信任: <span class="red">相信</span>他人不会<span class="red">伤害自己</span>或<span class="red">违背约定</span>.</p>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><a href="https://drhuyue.site:10002/sammo3182/figure/lv_interTrust.png" class="lightbox" data-gallery="quarto-lightbox-gallery-15"><img data-src="https://drhuyue.site:10002/sammo3182/figure/lv_interTrust.png" class="quarto-figure quarto-figure-center" height="300"></a></p>
</figure>
</div>
</div>
</div><div class="column fragment" style="width:50%;">
<p>指标：</p>
<ol type="1">
<li>总体而言，您是认同多数人是值得信任的，还是防人之心不可无？</li>
<li>您认为多数时候人们是乐于助人的还是自私自利的？</li>
<li>如果有机会，您认为别人是会占您便宜，还是说会恪守约定、公平行事？</li>
</ol>
</div>
</div>
<aside><ol class="aside-footnotes"><li id="fn4"><p>但维度拆分，<span class="red">艺术&gt;技术</span>.</p></li></ol></aside></section>
<section id="另一个运动员评价" class="slide level2">
<h2>另一个🌰：运动员评价</h2>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><a href="https://drhuyue.site:10002/sammo3182/figure/lv_multitrait.png" class="lightbox" data-gallery="quarto-lightbox-gallery-16"><img data-src="https://drhuyue.site:10002/sammo3182/figure/lv_multitrait.png" class="quarto-figure quarto-figure-center" height="600"></a></p>
</figure>
</div>
<aside class="notes">
<p>裁判对滑雪运动员的评判</p>
<p>单侧: factor complexity = 1 （一个变量只贡献一个latent）<br>
双侧: factor complexity &gt; 1</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="定义公式" class="slide level2">
<h2>定义公式</h2>
<div class="columns">
<div class="column" style="width:40%;">
<div class="callout callout-important callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Important</strong></p>
</div>
<div class="callout-content">
<p><span class="math display">\[
\begin{align}
X^* =&amp; \Phi\Lambda' + \epsilon; \\
X =&amp; \Lambda X_\xi + \epsilon,
\end{align}
\]</span></p>
<div style="text-align:center">
<p><strong>X</strong>： 指标向量<br>
<strong>ξ</strong>：潜在变量<br>
<strong>Λ<sub>X</sub></strong>: X = f(ξ)系数(a.k.a., loading, path)<br>
<strong>ε</strong>：偏误向量</p>
<p><strong>Φ</strong>: 潜在变量的协方差矩阵<br>
<strong>Θ<sub>ε</sub></strong>: 偏误的协方差矩阵</p>
</div>
</div>
</div>
</div>
<aside class="notes">
<p><strong>ξ</strong>: ksi<br>
<strong>δ</strong>: delta<br>
<strong>Φ</strong>: phi<br>
<strong>Θ<sub>σ</sub></strong>: theta</p>
<p>在EFA中潜在变量在等号左边，观测变量在右边</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</div><div class="column fragment" style="width:60%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><a href="https://drhuyue.site:10002/sammo3182/figure/lv_partMultitrait.png" class="lightbox" data-gallery="quarto-lightbox-gallery-17"><img data-src="https://drhuyue.site:10002/sammo3182/figure/lv_partMultitrait.png" class="quarto-figure quarto-figure-center" height="600"></a></p>
</figure>
</div>
</div>
</div>
</section>
<section id="估算" class="slide level2">
<h2>估算</h2>
<p><span class="red">测量矩阵</span></p>
<p><span class="math display">\[
\begin{bmatrix}
x_1\\
x_2\\
x_3\\
x_4\\
x_5
\end{bmatrix} =
\begin{bmatrix}
1 &amp; 1 &amp; 0\\
\lambda_{21} &amp; 1 &amp; 0\\
\lambda_{31} &amp; 1 &amp; 0\\
\lambda_{41} &amp; 0 &amp; 1\\
\lambda_{51} &amp; 0 &amp; 1
\end{bmatrix} \begin{bmatrix}\xi_1\\
\xi_2\\
\xi_3
\end{bmatrix} + \begin{bmatrix}\epsilon_1\\
\epsilon_2\\
\epsilon_3\\
\epsilon_4\\
\epsilon_5
\end{bmatrix}
\]</span></p>
<div class="columns">
<div class="column" style="width:35%;">
<p><span class="navy">潜变量矩阵</span></p>
<p><span class="math display">\[\Phi = \begin{bmatrix}
\phi_{11} &amp; &amp; \\
0 &amp; \phi_{22} &amp; \\
0 &amp; \phi_{23} &amp; \phi_{33}
\end{bmatrix}\]</span></p>
<aside class="notes">
<p>φ23$: classical 和showy 裁判的相关性</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</div><div class="column" style="width:65%;">
<p><span class="green">偏误矩阵</span></p>
<p>diag <strong>Θ<sub>σ</sub></strong> = diag[var(ε<sub>1</sub>) var(ε<sub>2</sub>)…var(ε<sub>5</sub>)]</p>
</div>
</div>
<div class="fragment">
<p>似曾相识？</p>
</div>
</section>
<section id="identification" class="slide level2">
<h2>Identification</h2>
<p>a.k.a., 最多能连多少线？</p>
<div class="columns">
<div class="column" style="width:50%;">
<p>Identified: 当<strong>Λ、Φ、Θ</strong>存在唯一解</p>
<p><strong>Λ</strong>: <span class="math inline">\(X = f(\xi)\)</span>系数 (a.k.a., loading)；<br>
<strong>Φ</strong>: 潜在变量的协方差矩阵；<br>
<strong>Θ</strong>: 偏误的协方差矩阵。</p>
<div class="fragment">
<p><strong>t rule</strong>:</p>
<p>t &lt; q(q + 1)/2</p>
<p>t: 不可见<br>
q：可见</p>
</div>
<aside class="notes">
<p>Another way to calculate df.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</div><div class="column" style="width:50%;">
<p>为保证identifable进行的限制</p>
<ol type="1">
<li class="fragment">Scaling
<ul>
<li class="fragment">λ<sub>11</sub> = 1;</li>
<li class="fragment">将潜在变量方差设为1(Standardized metric)</li>
</ul></li>
<li class="fragment">参数调整
<ul>
<li class="fragment">特定因子loading设为0；</li>
<li class="fragment">偏误的协方差设为0；</li>
<li class="fragment">偏误的方差设为0；</li>
</ul></li>
</ol>
</div>
</div>
</section>
<section id="最优解" class="slide level2">
<h2>最优解</h2>
<p><span class="math display">\[\Sigma(\theta) = \Lambda_X\Phi\Lambda_X' + \Theta_\epsilon,\]</span> <strong>Σ</strong>: 所有可见指标得协方差矩阵</p>
<aside class="notes">
<p>寻找最优<strong>Σ</strong></p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
<div class="columns">
<div class="column fragment" style="width:50%;">
<p>全信息估计 (Maximum likelihood)</p>
<ul>
<li>Generalized Least Squares<br>
</li>
<li>Unweighted Least Squares</li>
</ul>
</div><div class="column fragment" style="width:50%;">
<p>有限信息估计</p>
<ul>
<li>Two Stage Least Squares</li>
</ul>
</div>
</div>
</section>
<section id="常见问题" class="slide level2">
<h2>常见问题</h2>
<div class="columns">
<div class="column" style="width:35%;">
<p><code>错误：待分析的矩阵不是正定的</code></p>
<ul>
<li class="fragment">数据或协方差矩阵中录入错误</li>
<li class="fragment">缺失数据</li>
<li class="fragment">完全共线性</li>
<li class="fragment">异常值</li>
</ul>
</div><div class="column" style="width:35%;">
<p><code>错误：不恰当的解</code></p>
<ul>
<li class="fragment">录入错误</li>
<li class="fragment">总体至接近变量边界，加之抽样波动</li>
<li class="fragment">模型错误</li>
<li class="fragment">因素指标观测量过小（&lt;150左右）且只有2指标</li>
<li class="fragment">“Unlucky”样本</li>
<li class="fragment">异常值</li>
</ul>
</div><div class="column" style="width:30%;">
<p><code>错误：未收敛</code></p>
<ul>
<li class="fragment">录入错误</li>
<li class="fragment">Unidentifiable</li>
<li class="fragment">模型不佳</li>
<li class="fragment">起始值不佳</li>
<li class="fragment">小样本（N&lt;100）</li>
<li class="fragment">每个因素只有2指标</li>
<li class="fragment">异常值</li>
<li class="fragment">观测变量量纲极大差异</li>
</ul>
</div>
</div>
<aside class="notes">
<p><code>Error: Matrix to be analyzed not positive definite</code></p>
<ul>
<li>Typo in data file or covariance matrix</li>
<li>Pairwise deletion of missing data</li>
<li>Perfect collinearity</li>
<li>Outliers/influential cases</li>
</ul>
<p><code>Error: Improper solutions</code></p>
<ul>
<li>Typo in program</li>
<li>Population value near the borderline combined with sampling fluctuation</li>
<li>Specification error</li>
<li>Small samples (&lt;150 or so) combined with 2 indicators per factor</li>
<li>“unlucky” sample</li>
<li>Outliers/influential cases</li>
</ul>
<p><code>Error: Nonconvergence</code></p>
<ul>
<li>Typo in program, data file, or covariance matrix</li>
<li>Underidentified model</li>
<li>Poor model specification</li>
<li>Bad starting values</li>
<li>Small samples (N&lt;100)</li>
<li>Only 2 indicators per factor</li>
<li>Outliers/influential cases</li>
<li>Observed variables in very different scale</li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="诊断" class="slide level2">
<h2>诊断</h2>
<p><em>Overall: χ<sup>2</sup></em>，结果<span class="red">显著</span>则说明整体模型可能<span class="red">有问题</span>。<sup>1</sup></p>
<aside class="notes">
<ol type="1">
<li>Because models are almost always incorrect, any otherwise reasonably fitting model can be rejected when sample size is sufficient</li>
<li>Also a poor fitting model could be accepted if there is insufficient power to detect misspecification.</li>
</ol>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
<div class="fragment">
<p><em>Incremental Fit Indices</em>：将模型与基线模型比较</p>
<ol type="1">
<li>Tucker-Lewis Index (TLI, ρ<sub>2</sub>, Non-Normed Fit Index)</li>
<li>Comparative Fit Index (CFI)</li>
</ol>
</div>
<aside class="notes">
<p>基线模型：只保留可见变量的方差和协方差</p>
<p>1 理想情况<br>
&lt;.95 不可接受</p>
<p>CFI可以&gt;1, 这种情况视为1</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
<div class="fragment">
<p><em>Absolute Fit Indices</em></p>
<ol type="1">
<li>Root Mean Square Error of Approximation (RMSEA)</li>
<li>Standardized Root Mean Square Residual (SRMR)</li>
</ol>
</div>
<aside class="notes">
<ul>
<li>0 理想情况</li>
<li>≤ 0.05 不错</li>
<li>0.05 ~ 0.08 差强人意</li>
<li>≥ 0.1 不可接受</li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
<aside><ol class="aside-footnotes"><li id="fn5"><p>然而，当N足够大时χ<sup>2</sup>通常显著。</p></li></ol></aside></section>
<section id="holzinger-swineford-1939" class="slide level2">
<h2>🌰 Holzinger &amp; Swineford 1939</h2>
<p>对初中生精神状况的调查： 视觉因素（x<sub>1~3</sub>） + 阅读因素（x<sub>4~6</sub>）+ （表达因素：x<sub>7~9</sub>）</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><a href="03_latentVariableI_files/figure-revealjs/diagram-cfa-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-18"><img data-src="03_latentVariableI_files/figure-revealjs/diagram-cfa-1.png" class="quarto-figure quarto-figure-center" width="960"></a></p>
</figure>
</div>
</div>
</div>
</section>
<section id="估测结果与诊断" class="slide level2">
<h2>估测结果与诊断</h2>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6.17 ended normally after 35 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        21

  Number of observations                           301

Model Test User Model:
                                                      
  Test statistic                                85.306
  Degrees of freedom                                24
  P-value (Chi-square)                           0.000

Model Test Baseline Model:

  Test statistic                               918.852
  Degrees of freedom                                36
  P-value                                        0.000

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.931
  Tucker-Lewis Index (TLI)                       0.896

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)              -3737.745
  Loglikelihood unrestricted model (H1)      -3695.092
                                                      
  Akaike (AIC)                                7517.490
  Bayesian (BIC)                              7595.339
  Sample-size adjusted Bayesian (SABIC)       7528.739

Root Mean Square Error of Approximation:

  RMSEA                                          0.092
  90 Percent confidence interval - lower         0.071
  90 Percent confidence interval - upper         0.114
  P-value H_0: RMSEA &lt;= 0.050                    0.001
  P-value H_0: RMSEA &gt;= 0.080                    0.840

Standardized Root Mean Square Residual:

  SRMR                                           0.065

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  visual =~                                           
    x1                1.000                           
    x2                0.554    0.100    5.554    0.000
    x3                0.729    0.109    6.685    0.000
  textual =~                                          
    x4                1.000                           
    x5                1.113    0.065   17.014    0.000
    x6                0.926    0.055   16.703    0.000
  speed =~                                            
    x7                1.000                           
    x8                1.180    0.165    7.152    0.000
    x9                1.082    0.151    7.155    0.000

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  visual ~~                                           
    textual           0.408    0.074    5.552    0.000
    speed             0.262    0.056    4.660    0.000
  textual ~~                                          
    speed             0.173    0.049    3.518    0.000

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .x1                0.549    0.114    4.833    0.000
   .x2                1.134    0.102   11.146    0.000
   .x3                0.844    0.091    9.317    0.000
   .x4                0.371    0.048    7.779    0.000
   .x5                0.446    0.058    7.642    0.000
   .x6                0.356    0.043    8.277    0.000
   .x7                0.799    0.081    9.823    0.000
   .x8                0.488    0.074    6.573    0.000
   .x9                0.566    0.071    8.003    0.000
    visual            0.809    0.145    5.564    0.000
    textual           0.979    0.112    8.737    0.000
    speed             0.384    0.086    4.451    0.000</code></pre>
</div>
</div>
</section>
<section id="结构方程模型" class="slide level2">
<h2>结构方程模型</h2>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li>Structural equation model (SEM)<br>
</li>
<li>LISREL (Linear Structural ReLationships) models<br>
</li>
<li>Covariance structure models<br>
</li>
<li>Latent variable models<br>
</li>
<li>Structural equations with latent variables</li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><a href="https://drhuyue.site:10002/sammo3182/figure/lv_sem.png" class="lightbox" data-gallery="quarto-lightbox-gallery-19"><img data-src="https://drhuyue.site:10002/sammo3182/figure/lv_sem.png" class="fragment quarto-figure quarto-figure-center" height="200"></a></p>
</figure>
</div>
</div><div class="column fragment" style="width:50%;">
<ul>
<li>Confirmative factor analysis<br>
</li>
<li>Multiple regression<br>
</li>
<li>Multivariate regression<br>
</li>
<li>ANOVA<br>
</li>
<li>General linear model<br>
</li>
<li>Path analysis<br>
</li>
<li>Recursive models<br>
</li>
<li>Dichotomous and ordered probit<br>
</li>
<li>Seemingly unrelated regressions<br>
</li>
<li>Simultaneous models<br>
</li>
<li>Latent growth curve models<br>
……</li>
</ul>
</div>
</div>
</section>
<section id="sem-in-terms-of-cfa" class="slide level2">
<h2>SEM (in terms of CFA)</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p><strong>结构</strong></p>
<ul>
<li class="fragment">观察变量： X + Y</li>
<li class="fragment">模型建构：
<ol type="1">
<li class="fragment">Latent variable model</li>
<li class="fragment">Measurement model (CFA)</li>
<li class="fragment">Relations among the errors</li>
</ol></li>
<li class="fragment">依然要求identification</li>
</ul>
<p><strong>估计</strong>：MLE</p>
</div><div class="column" style="width:50%;">
<p><strong>诊断</strong> (完全一样)</p>
<ul>
<li class="fragment">Overall：χ<sup>2</sup></li>
<li class="fragment">Incremental：
<ul>
<li class="fragment">TLI &amp; CLI</li>
<li class="fragment">Incremental Fit Index(IFI, Δ<sup>2</sup>)</li>
</ul></li>
<li class="fragment">Absolute:
<ul>
<li class="fragment">RMSEA</li>
<li class="fragment">BIC</li>
</ul></li>
</ul>
</div>
</div>
<div class="fragment">
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>SEM进阶</strong></p>
</div>
<div class="callout-content">
<p><em>敬请注意</em>：<span class="red">SEM结果仍表现相关关系。</span></p>
<p>处理Measurement errors；处理非线性变量(hint: GSEM)；纳入多层效应；处理缺失值</p>
</div>
</div>
</div>
</div>
</section>
<section id="bollen-1989" class="slide level2">
<h2>🌰 Bollen 1989</h2>
<p>政治民主（1960，1965）与工业化</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><a href="03_latentVariableI_files/figure-revealjs/diagram-sem-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-20"><img data-src="03_latentVariableI_files/figure-revealjs/diagram-sem-1.png" class="quarto-figure quarto-figure-center" width="960"></a></p>
</figure>
</div>
</div>
</div>
</section>
<section id="结果与诊断" class="slide level2">
<h2>结果与诊断</h2>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6.17 ended normally after 68 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        31

  Number of observations                            75

Model Test User Model:
                                                      
  Test statistic                                38.125
  Degrees of freedom                                35
  P-value (Chi-square)                           0.329

Model Test Baseline Model:

  Test statistic                               730.654
  Degrees of freedom                                55
  P-value                                        0.000

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.995
  Tucker-Lewis Index (TLI)                       0.993

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)              -1547.791
  Loglikelihood unrestricted model (H1)      -1528.728
                                                      
  Akaike (AIC)                                3157.582
  Bayesian (BIC)                              3229.424
  Sample-size adjusted Bayesian (SABIC)       3131.720

Root Mean Square Error of Approximation:

  RMSEA                                          0.035
  90 Percent confidence interval - lower         0.000
  90 Percent confidence interval - upper         0.092
  P-value H_0: RMSEA &lt;= 0.050                    0.611
  P-value H_0: RMSEA &gt;= 0.080                    0.114

Standardized Root Mean Square Residual:

  SRMR                                           0.044

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  ind60 =~                                            
    x1                1.000                           
    x2                2.180    0.139   15.742    0.000
    x3                1.819    0.152   11.967    0.000
  dem60 =~                                            
    y1                1.000                           
    y2                1.257    0.182    6.889    0.000
    y3                1.058    0.151    6.987    0.000
    y4                1.265    0.145    8.722    0.000
  dem65 =~                                            
    y5                1.000                           
    y6                1.186    0.169    7.024    0.000
    y7                1.280    0.160    8.002    0.000
    y8                1.266    0.158    8.007    0.000

Regressions:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  dem60 ~                                             
    ind60             1.483    0.399    3.715    0.000
  dem65 ~                                             
    ind60             0.572    0.221    2.586    0.010
    dem60             0.837    0.098    8.514    0.000

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
 .y1 ~~                                               
   .y5                0.624    0.358    1.741    0.082
 .y2 ~~                                               
   .y4                1.313    0.702    1.871    0.061
   .y6                2.153    0.734    2.934    0.003
 .y3 ~~                                               
   .y7                0.795    0.608    1.308    0.191
 .y4 ~~                                               
   .y8                0.348    0.442    0.787    0.431
 .y6 ~~                                               
   .y8                1.356    0.568    2.386    0.017

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .x1                0.082    0.019    4.184    0.000
   .x2                0.120    0.070    1.718    0.086
   .x3                0.467    0.090    5.177    0.000
   .y1                1.891    0.444    4.256    0.000
   .y2                7.373    1.374    5.366    0.000
   .y3                5.067    0.952    5.324    0.000
   .y4                3.148    0.739    4.261    0.000
   .y5                2.351    0.480    4.895    0.000
   .y6                4.954    0.914    5.419    0.000
   .y7                3.431    0.713    4.814    0.000
   .y8                3.254    0.695    4.685    0.000
    ind60             0.448    0.087    5.173    0.000
   .dem60             3.956    0.921    4.295    0.000
   .dem65             0.172    0.215    0.803    0.422</code></pre>
</div>
</div>
</section>
<section id="总结" class="slide level2">
<h2>总结</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="fragment">
<ul>
<li>潜在变量分析概述
<ul>
<li><em>因素分析</em></li>
<li>类型分析</li>
</ul></li>
</ul>
</div>
<div class="fragment">
<ul>
<li>EFA
<ul>
<li>探索性因子分析：通过loading找到潜在变量</li>
<li>EFA诊断：Kaiser’s criterion</li>
<li>EFA vs.&nbsp;PCA: 结果相似，逻辑不同</li>
</ul></li>
</ul>
</div>
</div><div class="column" style="width:50%;">
<div class="fragment">
<ul>
<li>CFA
<ul>
<li>验证性因子分析：检验潜在变量对于观察指标是否有影响</li>
<li>CFA诊断：χ<sup>2</sup>, TLI/CFI，RMSEA/SRMR</li>
</ul></li>
</ul>
</div>
<div class="fragment">
<ul>
<li>SEM
<ul>
<li>Latent + measurement models</li>
<li>不能证明因果关系！</li>
</ul></li>
</ul>
</div>
</div>
</div>
<div class="fragment">
<div class="r-fit-text">
<p><strong>待解之题</strong>：观测变量与潜变量之间关系要是<span class="red">非线性</span>的呢？</p>
</div>
</div>

</section><div class="quarto-auto-generated-content">
<div class="footer footer-default">

</div>
</div></section>

    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="03_latentVariableI_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="03_latentVariableI_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="03_latentVariableI_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="03_latentVariableI_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="03_latentVariableI_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="03_latentVariableI_files/libs/revealjs/plugin/reveal-spotlight/spotlight.js"></script>
  <script src="03_latentVariableI_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="03_latentVariableI_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="03_latentVariableI_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="03_latentVariableI_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="03_latentVariableI_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'spotlight': {"size":50,"lockPointerInsideCanvas":false,"toggleSpotlightOnMouseDown":false,"spotlightOnKeyPressAndHold":73,"spotlightCursor":"none","presentingCursor":"default","initialPresentationMode":true,"disablingUserSelect":true,"fadeInAndOut":100,"useAsPointer":false,"pointerColor":"red"},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: true,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealSpotlight, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        text: function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp('/' + window.location.host + '/');
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
              // target, if specified
              link.setAttribute("target", "_blank");
              if (link.getAttribute("rel") === null) {
                link.setAttribute("rel", "noopener");
              }
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    <script>var lightboxQuarto = GLightbox({"closeEffect":"fade","selector":".lightbox","openEffect":"fade","descPosition":"bottom","loop":false});
    window.onload = () => {
      lightboxQuarto.on('slide_before_load', (data) => {
        const { slideIndex, slideNode, slideConfig, player, trigger } = data;
        const href = trigger.getAttribute('href');
        if (href !== null) {
          const imgEl = window.document.querySelector(`a[href="${href}"] img`);
          if (imgEl !== null) {
            const srcAttr = imgEl.getAttribute("src");
            if (srcAttr && srcAttr.startsWith("data:")) {
              slideConfig.href = srcAttr;
            }
          }
        } 
      });

      lightboxQuarto.on('slide_after_load', (data) => {
        const { slideIndex, slideNode, slideConfig, player, trigger } = data;
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(slideNode);
        }
      });

    };
              </script>
    

</body></html>