<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Cross-Survey Analysis and Dynamic Comparative Public Opinion</title>
    <meta charset="utf-8" />
    <meta name="author" content="Yue Hu" />
    <meta name="date" content="2021-06-10" />
    <script src="dcpo_files/header-attrs-2.8/header-attrs.js"></script>
    <link href="dcpo_files/remark-css-0.0.1/default.css" rel="stylesheet" />
    <link href="dcpo_files/tile-view-0.2.4/tile-view.css" rel="stylesheet" />
    <script src="dcpo_files/tile-view-0.2.4/tile-view.js"></script>
    <link href="dcpo_files/tachyons-4.12.0/tachyons.min.css" rel="stylesheet" />
    <link href="dcpo_files/panelset-0.2.4/panelset.css" rel="stylesheet" />
    <script src="dcpo_files/panelset-0.2.4/panelset.js"></script>
    <script src="dcpo_files/js-cookie-3.0.0/js.cookie.js"></script>
    <script src="dcpo_files/peerjs-1.3.1/peerjs.min.js"></script>
    <script src="dcpo_files/tiny.toast-1.0.0/toast.min.js"></script>
    <link href="dcpo_files/xaringanExtra-broadcast-0.2.4/broadcast.css" rel="stylesheet" />
    <script src="dcpo_files/xaringanExtra-broadcast-0.2.4/broadcast.js"></script>
    <link rel="stylesheet" href="zh-CN_custom.css" type="text/css" />
    <link rel="stylesheet" href="style_ui.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Cross-Survey Analysis and Dynamic Comparative Public Opinion
### Yue Hu
### 2021-06-10

---


class: inverse, bottom




+ Common issue in comparative politics
+ Methodological solution
+ A new method: DCPO
+ New findings 

# Overview

---

class: center, middle

.bg-black.golden.ba.shadow-5.ph4.mt3.center[
Social scientists aim for patterns in a society.
]


.large[Common issues]    
.small[Development, culture, democracy...]

\+ 

.large[Rich data]    
.small[WVS, Global Barometers, ?GSS, Pew ...]


.large[.red[&amp;#10504;]]

.large[General patterns]


---

## E.g.: Democracy &amp;larr;?&amp;rarr; Public support

Support .navy[&amp;uarr;] &amp;rarr; democracy .navy[&amp;uarr;] .small[(e.g., Inglehart &amp; Welzel 2005, Claassen 2019)]    
Support .navy[&amp;uarr;] &amp;rarr; democracy .red[&amp;#8675;] .small[(e.g., Fails &amp; Pierce 2010)]

???

Countries with greater democratic support have been found to become stronger and more stable democracies

Inglehart, Ronald and Christian Welzel. 2005. *Modernization, Cultural Change, and Democracy*. Cambridge: Cambridge University Press. 

Fails, Matthew D. and Heather Nicole Pierce. 2010. “Changing Mass Attitudes and Democratic Deepening.” *Political Research Quarterly* 63(1):174–187.

(Insignificant positive with one-year survey, and insig negative with multiple years)

--

Democracy .navy[&amp;uarr;] &amp;rarr; support .navy[&amp;uarr;] .small[(e.g., Wuttke et. al. 2020) ]   
Democracy .navy[&amp;uarr;] &amp;rarr; support .red[&amp;darr;] .small[(e.g., Foa &amp; Mounk 2017)]  
Democracy .red[&amp;darr;] &amp;rarr; support .navy[&amp;uarr;] .small[(Claassen 2020)]

???
More experience with democracy yields more democratic support 
vs.
Long-established democracies are suffering from democratic fatigue 

Wuttke, Alexander, Christian Schimpf and Harald Schoen. 2020. “When the Whole Is Greater
than the Sum of Its Parts: On the Conceptualization and Measurement of Populist Attitudes and Other Multidimensional Constructs.” *American Political Science Review* 114(2):356–374.

Foa, Roberto Stefan and Yascha Mounk. 2017. “The Signs of Deconsolidation.” *Journal of Democracy* 28(1):5–15

thermostatic effect. 

---

## Puzzle Makers: Invisible Opinions

.red[Different] questions

.center[&lt;img src="../conference/2021-AsianPoliMeth/images/sparsingData.png" height = 450 /&gt;]

???
Why are there mixed results? 
Difficutlies in measuring. 
First, pub sp is latent variable, unobservable. Uncertainty. 
Sec, a big challenge is the sparced and fragmented data at aggregate level. 
churchihill items,  democracy has its probles, still the best one. 
milltary rule items, military should govern the country. what do you think. 
Worldwide survey project, 4 years. 
across countries, overtime. 

---

.red[Different] respondents

.pull-left[
&lt;img src="../conference/2021-AsianPoliMeth/images/demo_leaving.gif" height = 350 /&gt;

]

--

.pull-right[
&lt;img src="../conference/2021-AsianPoliMeth/images/demo_enter.gif" height = 350 /&gt;

]

???

Different respondents have different concepts of democracy and different way to support democracy. 
United Kindom, lawmakers leave. 
Swarming Capital defending democracy.  

---

class: center, middle, large

Different questions   
Different people   
&amp;dArr;    
.red[Incomparable] data   


--

w. 

.blue[Latent variable analysis]


---

class: inverse, bottom

+ Typological modeling
+ Individual IRT
+ Group IRT
+ DCPO

# Methodology Moment

---

.center[World of Latent Variable Analysis]

.pull-left[
### Factorial Models

1. Exploratory Factor Analysis
1. Confirmative Factor Analysis
1. Structural Equation Model
]

.pull-right[
### Typological Models

1. Item Response Theory
1. Cross-Group Comparison(MrP, GIRT, DCPO)
]

--

.center[
## Operation

R&lt;sup&gt;\*&lt;/sup&gt;    
[`mirt`](https://github.com/philchalmers/mirt/wiki);    
[`DCPO`](https://github.com/fsolt/DCPO)
]

.footnote[[\*] R packages for IRT &gt; [50](https://www.tandfonline.com/doi/full/10.1080/15366367.2019.1586404?src=recsys).]

---

## Item Response Theory, IRT

Why not factor analyses?

--

1. The outcome is assumed .red[continual];
1. Different types (categorical, binary, ordinal, continual) of indicators are assumed .red[identical] in nature;
1. Ignoring .red[cross-group] differences;
1. EFA cannot address the .red[covariance] among indicators;
1. CFA: Simpler theory or .red[low-fit] model.

???

CFA理论通常简略，只涉及一部分indices，但实际可能很复杂；当囊括更多indices测量质量会高，但不符合理论。

---

class: middle

.center[
## Why IRT
]

1. Created for .red[noncontinuous] variables (binary &amp;rarr; ordinal + continuous);

--

1. Open to incorporate with .red[Bayesian] inference and no .red[scaling] issue;

--

1. Better dealing with .red["don't know"s] within the Bayesian framework

--

1. Being Enable .red[cross-group] comparison.

---

## Individual-Level IRT

Usage: Within-survey latent variable analysis

Objective:

1. Yes/No;
1. Responses that can convert to binary;
3. Ordinal responses(e.g., Liker scale questions).

---

class: large

### IRT Assumption

1. Monotonicity
1. Unidimensionality
1. Local independence
1. Parameter invariance

---

class: center, middle, large

# Monotonicity

Trait level &amp;uarr; &amp;prop; Pr(=1) &amp;uarr;

&lt;img src="../courses/governmentalBigData/images/irt_icc.png" height = 350 /&gt;

???

As the trait level is increasing, the probability of a correct response (=1) also increases.

单增趋势：随潜在变量增加，获得1的可能性也随之增加。

Item characteristic curve

比如随着能力的提高，回答正确答案的机会也就越高

---

class: center, middle, large

# Unidimensionality

One dominant latent variable &amp;rarr; Observed items

???

One dominant latent trait driving force for the responses observed for each item

+ 聚合的项目均指向同一个潜在变量。  
+ 基于理论  

--

Until the multidimensional IRT

---

class: center, middle, large

# Local Independency

.red[cov(items) &amp;larr; latent trait]

P(y&lt;sub&gt;iq&lt;/sub&gt;,y&lt;sub&gt;i'q&lt;/sub&gt; | &amp;theta;&lt;sub&gt;q&lt;/sub&gt;) = P(y&lt;sub&gt;iq&lt;/sub&gt; | &amp;theta;&lt;sub&gt;q&lt;/sub&gt;)P(y&lt;sub&gt;i'q&lt;/sub&gt; | &amp;theta;&lt;sub&gt;q&lt;/sub&gt;)

???

Responses given to the separate items in a test are mutually independent given a certain level of ability.

对于每一项目（e.g.,一道题）的响应(e.g., 选择的选项)间的关联性.red[只]来自.red[共同]的潜在变量。

换言之，控制潜在变量影响后，问题间响应相互独立

---

class: middle, large

# Parameter Invariance

+ Invariance among items
+ Invariance among respondents&lt;sup&gt;\*&lt;/sup&gt;

.footnote[&lt;sup&gt;\*&lt;/sup&gt; Check the differential item functioning (DIF) with Wald and likelihood-ratio approach.]

???

+ Parameters在项目间不变
+ Parameters在响应人群间不变&lt;sup&gt;1&lt;/sup&gt;
    + 当进行Multiple Group IRT时尤可能被违反

Easy to be avoid when involving multi-group IRT

---

## IRT Models

### Individual IRT
Rasch Model (1PL)     
&amp;rarr; Two-Parameter Logistic Model (2PL)     
&amp;rarr; Three-Parameter Logistic Model (3PL)     
&amp;rarr; Four-Parameter Logistic Model (4PL)

### Group IRT

MIRT    
&amp;rarr; DGIRT    
&amp;rarr; DCPO

---

## Rasch Model (1PL)

+ y&lt;sub&gt;iq&lt;/sub&gt;&amp;isin;{0,1}: subject `i`'s score on question `q`
+ &amp;theta;&lt;sub&gt;i&lt;/sub&gt;&amp;isin;{-&amp;infin;, +&amp;infin;}: Unbounded latent trait
+ &amp;sigma;&lt;sub&gt;q&lt;/sub&gt;: Difficulty

.pull-left[.center[.orange[Pr(y&lt;sub&gt;iq&lt;/sub&gt; = 1)] = ]]
.pull-right[.navy[logist&lt;sup&gt;-1&lt;/sup&gt;(&amp;theta;&lt;sub&gt;i&lt;/sub&gt; - &amp;sigma;&lt;sub&gt;q&lt;/sub&gt;])]


???

Rasch /resh/  

Difficulty: 不同的问题回答肯定答案的难易度不一样, 通常显示为z scores， 低于0 表示比较简单
+ 当面临重大公共卫生威胁时，政府应该及时响应，采取果断措施
+ 政府是否可以牺牲少数民众安全和权力，来换取大多数社会成员的公共卫生安全时

--

.pull-left[
.orange[.large[Item Response]]
]

.pull-right[
.navy[.large[Response Theory]]
]

---

## An Simple Example (Bock &amp; Lieberman 1970)

Law School Admissions Test, sec 7  
5 yes/no questions

&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt;   &lt;/th&gt;
   &lt;th style="text-align:left;"&gt;     Item.1 &lt;/th&gt;
   &lt;th style="text-align:left;"&gt;     Item.2 &lt;/th&gt;
   &lt;th style="text-align:left;"&gt;     Item.3 &lt;/th&gt;
   &lt;th style="text-align:left;"&gt;     Item.4 &lt;/th&gt;
   &lt;th style="text-align:left;"&gt;     Item.5 &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt;  &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Min.   :0.000 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Min.   :0.000 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Min.   :0.000 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Min.   :0.000 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Min.   :0.000 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt;  &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 1st Qu.:1.000 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 1st Qu.:0.000 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 1st Qu.:1.000 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 1st Qu.:0.000 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 1st Qu.:1.000 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt;  &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Median :1.000 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Median :1.000 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Median :1.000 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Median :1.000 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Median :1.000 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt;  &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Mean   :0.828 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Mean   :0.658 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Mean   :0.772 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Mean   :0.606 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Mean   :0.843 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt;  &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 3rd Qu.:1.000 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 3rd Qu.:1.000 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 3rd Qu.:1.000 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 3rd Qu.:1.000 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 3rd Qu.:1.000 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt;  &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Max.   :1.000 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Max.   :1.000 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Max.   :1.000 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Max.   :1.000 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Max.   :1.000 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

???

[`mirt` Workshop 1](http://philchalmers.github.io/mirt/extra/mirt-Workshop-2015_Day-1.pdf)

---

## Difficulty Parameter


```r
m_lsat &lt;- mirt(df_lsat, model = 1, itemtype = "Rasch", verbose = FALSE)
coef(m_lsat, simplify = TRUE) %&gt;% 
  kable(format = "html")
```

&lt;table class="kable_wrapper"&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td&gt; 

&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt;   &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; a1 &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; d &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; g &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; u &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Item.1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1.8680718 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Item.2 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.7909134 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Item.3 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1.4608233 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Item.4 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.5214399 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Item.5 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1.9927710 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

 &lt;/td&gt;
   &lt;td&gt; 

&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt;   &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; x &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; F1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

 &lt;/td&gt;
   &lt;td&gt; 

&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt;   &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; F1 &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; F1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1.021944 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

???

The difficulty parameter is the `d`

The rest parameters we'll talk in 2pl and 3pl

---

class: center, middle

.bg-black.golden.ba.shadow-5.ph4.mt3.center[
.large[Please always diagnose your results]
]

--

.bg-black.golden.ba.shadow-5.ph4.mt3.center[
.large[and .red[understand] what you are diagnosing.]

.tr[
— Dr. Hu
]]

---

## IRT Diagnoses

+ General level：Global fit
+ Item level：Item fit &amp; residual
+ Respondent level：Personal fit

---

## Global Fit&lt;sup&gt;1&lt;/sup&gt;

`$$G^2 = 2[\sum_l^s r_lln(\frac{r_l}{N\tilde{P}_l})]$$`

N: Number of respondents  
l: Possible options   
r: Number of respondents who respond with l

--

When item &gt; 10，M&lt;sup&gt;2&lt;/sup&gt;, M&lt;sup&gt;2&lt;/sup&gt;* (Modified version of G&lt;sup&gt;2&lt;/sup&gt;)


```r
M2(m_lsat)
```

```
##             M2 df          p     RMSEA   RMSEA_5   RMSEA_95      SRMSR
## stats 23.17287 10 0.01012618 0.0363126 0.0168065 0.05586376 0.04744033
##             TLI       CFI
## stats 0.9401263 0.9401263
```


.footnote[
[1] RMSEA, SRMSR, CFI, TLI also works
]

???

REDO: @Maydeu-Olivares2013

N is the number of subjects, L is number of possible response patterns, `\(P_ l\)` is the estimated probability of observing response pattern l, and `\(r_ l\)` is the number of subjects who have response pattern l

&amp;chi; sig   
Tucker-lewis index, 1 ideal, &lt; .95 poor   
Comparative fit index, the same   
Root mean square error of approximation, 0 perfect, &lt;.05 good, [.05, .08] ok, &gt; .1 poor    
Standardized root mean square residual &lt;.08 acceptable

---

## Item Characteristic Curves （ICC）

![](dcpo_files/figure-html/icc-1.png)&lt;!-- --&gt;

???

检查各题affirmative的难易程度，看逐个是不是大体同一个趋势

---

## Test Charactersitic Curve

![](dcpo_files/figure-html/tcc-1.png)&lt;!-- --&gt;

???

TCC： 所有ICC之和，体现how reliable, information 理想是形成一个钟形,顶尖处代表平均水平，据此对比个人&amp;theta;可以判断这人是否是outlier
SE(&amp;theta;) = (test)&lt;sup&gt;-1/2&lt;/sup&gt;

---

## Item Diagnostics

Covariation-based residuals


```r
residuals(m_lsat)
```

```
## LD matrix (lower triangle) and standardized values:
## 
##        Item.1 Item.2 Item.3 Item.4 Item.5
## Item.1     NA -0.017  0.020  0.022  0.019
## Item.2  0.292     NA  0.105 -0.042 -0.064
## Item.3  0.389 10.976     NA  0.007  0.007
## Item.4  0.474  1.801  0.055     NA -0.052
## Item.5  0.362  4.063  0.045  2.691     NA
```

???

看item residual的协变程度，多用于看multidimensionality, 不应有关联


---

Single item/person fit 


```r
# Item 
itemfit(m_lsat, fit_stats = "infit")
```

```
##     item outfit z.outfit infit z.infit
## 1 Item.1  0.744   -3.597 0.939  -1.025
## 2 Item.2  0.758   -7.500 0.826  -6.303
## 3 Item.3  0.711   -5.420 0.860  -3.202
## 4 Item.4  0.770   -8.877 0.818  -7.962
## 5 Item.5  0.797   -2.572 0.993  -0.081
```


```r
# Person
personfit(m_lsat)
```

```
##        outfit   z.outfit     infit     z.infit          Zh
## 1   0.6420958 -0.9001784 0.6953214 -0.96202244  0.93429336
## 2   0.6420958 -0.9001784 0.6953214 -0.96202244  0.93429336
## 3   0.6420958 -0.9001784 0.6953214 -0.96202244  0.93429336
## 4   0.6420958 -0.9001784 0.6953214 -0.96202244  0.93429336
## 5   0.6420958 -0.9001784 0.6953214 -0.96202244  0.93429336
## 6   0.6420958 -0.9001784 0.6953214 -0.96202244  0.93429336
## 7   0.6420958 -0.9001784 0.6953214 -0.96202244  0.93429336
## 8   0.6420958 -0.9001784 0.6953214 -0.96202244  0.93429336
## 9   0.6420958 -0.9001784 0.6953214 -0.96202244  0.93429336
## 10  0.6420958 -0.9001784 0.6953214 -0.96202244  0.93429336
## 11  0.6420958 -0.9001784 0.6953214 -0.96202244  0.93429336
## 12  0.6420958 -0.9001784 0.6953214 -0.96202244  0.93429336
## 13  0.8178336 -0.6300162 0.8365515 -0.58965745  0.64983876
## 14  0.8178336 -0.6300162 0.8365515 -0.58965745  0.64983876
## 15  0.8178336 -0.6300162 0.8365515 -0.58965745  0.64983876
## 16  0.8178336 -0.6300162 0.8365515 -0.58965745  0.64983876
## 17  0.8178336 -0.6300162 0.8365515 -0.58965745  0.64983876
## 18  0.8178336 -0.6300162 0.8365515 -0.58965745  0.64983876
## 19  0.8178336 -0.6300162 0.8365515 -0.58965745  0.64983876
## 20  0.8178336 -0.6300162 0.8365515 -0.58965745  0.64983876
## 21  0.8178336 -0.6300162 0.8365515 -0.58965745  0.64983876
## 22  0.8178336 -0.6300162 0.8365515 -0.58965745  0.64983876
## 23  0.8178336 -0.6300162 0.8365515 -0.58965745  0.64983876
## 24  0.8178336 -0.6300162 0.8365515 -0.58965745  0.64983876
## 25  0.8178336 -0.6300162 0.8365515 -0.58965745  0.64983876
## 26  0.8178336 -0.6300162 0.8365515 -0.58965745  0.64983876
## 27  0.8178336 -0.6300162 0.8365515 -0.58965745  0.64983876
## 28  0.8178336 -0.6300162 0.8365515 -0.58965745  0.64983876
## 29  0.8178336 -0.6300162 0.8365515 -0.58965745  0.64983876
## 30  0.8178336 -0.6300162 0.8365515 -0.58965745  0.64983876
## 31  0.8178336 -0.6300162 0.8365515 -0.58965745  0.64983876
## 32  1.4702553  1.6126462 1.4447540  1.61101087 -1.73598829
## 33  1.3927122  1.1849894 1.3937871  1.27940982 -1.28637186
## 34  1.3927122  1.1849894 1.3937871  1.27940982 -1.28637186
## 35  1.3927122  1.1849894 1.3937871  1.27940982 -1.28637186
## 36  1.3927122  1.1849894 1.3937871  1.27940982 -1.28637186
## 37  1.3927122  1.1849894 1.3937871  1.27940982 -1.28637186
## 38  1.3927122  1.1849894 1.3937871  1.27940982 -1.28637186
## 39  1.3927122  1.1849894 1.3937871  1.27940982 -1.28637186
## 40  1.0428516  0.2464647 1.0613929  0.32004646 -0.21273742
## 41  1.0428516  0.2464647 1.0613929  0.32004646 -0.21273742
## 42  1.0428516  0.2464647 1.0613929  0.32004646 -0.21273742
## 43  1.0023472  0.1156527 0.9806210  0.03358782  0.03962718
## 44  1.0023472  0.1156527 0.9806210  0.03358782  0.03962718
## 45  1.0023472  0.1156527 0.9806210  0.03358782  0.03962718
## 46  1.0023472  0.1156527 0.9806210  0.03358782  0.03962718
## 47  1.0023472  0.1156527 0.9806210  0.03358782  0.03962718
## 48  1.0023472  0.1156527 0.9806210  0.03358782  0.03962718
## 49  1.0023472  0.1156527 0.9806210  0.03358782  0.03962718
## 50  1.0023472  0.1156527 0.9806210  0.03358782  0.03962718
## 51  1.0023472  0.1156527 0.9806210  0.03358782  0.03962718
## 52  1.0023472  0.1156527 0.9806210  0.03358782  0.03962718
## 53  1.0023472  0.1156527 0.9806210  0.03358782  0.03962718
## 54  1.0023472  0.1156527 0.9806210  0.03358782  0.03962718
## 55  1.0023472  0.1156527 0.9806210  0.03358782  0.03962718
## 56  1.0023472  0.1156527 0.9806210  0.03358782  0.03962718
## 57  1.0023472  0.1156527 0.9806210  0.03358782  0.03962718
## 58  1.0023472  0.1156527 0.9806210  0.03358782  0.03962718
## 59  1.0023472  0.1156527 0.9806210  0.03358782  0.03962718
## 60  1.0023472  0.1156527 0.9806210  0.03358782  0.03962718
## 61  1.0023472  0.1156527 0.9806210  0.03358782  0.03962718
## 62  1.6793416  1.8478659 1.5976464  1.80384093 -2.03724960
## 63  1.6793416  1.8478659 1.5976464  1.80384093 -2.03724960
## 64  1.6793416  1.8478659 1.5976464  1.80384093 -2.03724960
## 65  1.4319232  0.9040008 1.3542229  0.89387872 -0.83441775
## 66  1.4319232  0.9040008 1.3542229  0.89387872 -0.83441775
## 67  1.4319232  0.9040008 1.3542229  0.89387872 -0.83441775
## 68  1.4319232  0.9040008 1.3542229  0.89387872 -0.83441775
## 69  1.4319232  0.9040008 1.3542229  0.89387872 -0.83441775
## 70  1.4319232  0.9040008 1.3542229  0.89387872 -0.83441775
## 71  1.4319232  0.9040008 1.3542229  0.89387872 -0.83441775
## 72  1.4319232  0.9040008 1.3542229  0.89387872 -0.83441775
## 73  1.4319232  0.9040008 1.3542229  0.89387872 -0.83441775
## 74  1.4319232  0.9040008 1.3542229  0.89387872 -0.83441775
## 75  1.4319232  0.9040008 1.3542229  0.89387872 -0.83441775
## 76  1.4319232  0.9040008 1.3542229  0.89387872 -0.83441775
## 77  1.4319232  0.9040008 1.3542229  0.89387872 -0.83441775
## 78  1.4319232  0.9040008 1.3542229  0.89387872 -0.83441775
## 79  1.4319232  0.9040008 1.3542229  0.89387872 -0.83441775
## 80  1.4319232  0.9040008 1.3542229  0.89387872 -0.83441775
## 81  1.4319232  0.9040008 1.3542229  0.89387872 -0.83441775
## 82  1.3283603  1.1925623 1.3435562  1.29493298 -1.29902533
## 83  1.3283603  1.1925623 1.3435562  1.29493298 -1.29902533
## 84  1.3283603  1.1925623 1.3435562  1.29493298 -1.29902533
## 85  1.3283603  1.1925623 1.3435562  1.29493298 -1.29902533
## 86  1.3283603  1.1925623 1.3435562  1.29493298 -1.29902533
## 87  1.3283603  1.1925623 1.3435562  1.29493298 -1.29902533
## 88  1.3283603  1.1925623 1.3435562  1.29493298 -1.29902533
## 89  1.3283603  1.1925623 1.3435562  1.29493298 -1.29902533
## 90  1.3283603  1.1925623 1.3435562  1.29493298 -1.29902533
## 91  1.3283603  1.1925623 1.3435562  1.29493298 -1.29902533
## 92  1.2804056  0.9003924 1.2754654  0.95116392 -0.90599298
## 93  1.2804056  0.9003924 1.2754654  0.95116392 -0.90599298
## 94  1.2804056  0.9003924 1.2754654  0.95116392 -0.90599298
## 95  1.2804056  0.9003924 1.2754654  0.95116392 -0.90599298
## 96  1.2804056  0.9003924 1.2754654  0.95116392 -0.90599298
## 97  1.9574000  2.4221949 1.8924908  2.48855647 -2.98286976
## 98  1.9574000  2.4221949 1.8924908  2.48855647 -2.98286976
## 99  1.9574000  2.4221949 1.8924908  2.48855647 -2.98286976
## 100 1.7753892  1.3847459 1.6548212  1.43482759 -1.53366231
## 101 1.7753892  1.3847459 1.6548212  1.43482759 -1.53366231
## 102 1.7753892  1.3847459 1.6548212  1.43482759 -1.53366231
## 103 1.7753892  1.3847459 1.6548212  1.43482759 -1.53366231
## 104 1.7753892  1.3847459 1.6548212  1.43482759 -1.53366231
## 105 1.7753892  1.3847459 1.6548212  1.43482759 -1.53366231
## 106 1.7753892  1.3847459 1.6548212  1.43482759 -1.53366231
## 107 1.5670351  1.5978712 1.4793247  1.50529970 -1.65687072
## 108 1.5670351  1.5978712 1.4793247  1.50529970 -1.65687072
## 109 1.5670351  1.5978712 1.4793247  1.50529970 -1.65687072
## 110 1.5670351  1.5978712 1.4793247  1.50529970 -1.65687072
## 111 1.5670351  1.5978712 1.4793247  1.50529970 -1.65687072
## 112 1.5670351  1.5978712 1.4793247  1.50529970 -1.65687072
## 113 1.5670351  1.5978712 1.4793247  1.50529970 -1.65687072
## 114 1.3208296  0.7321411 1.2189235  0.62398564 -0.55314427
## 115 1.3208296  0.7321411 1.2189235  0.62398564 -0.55314427
## 116 1.3208296  0.7321411 1.2189235  0.62398564 -0.55314427
## 117 1.3208296  0.7321411 1.2189235  0.62398564 -0.55314427
## 118 1.3208296  0.7321411 1.2189235  0.62398564 -0.55314427
## 119 1.3208296  0.7321411 1.2189235  0.62398564 -0.55314427
## 120 1.3208296  0.7321411 1.2189235  0.62398564 -0.55314427
## 121 1.3208296  0.7321411 1.2189235  0.62398564 -0.55314427
## 122 1.3208296  0.7321411 1.2189235  0.62398564 -0.55314427
## 123 1.3208296  0.7321411 1.2189235  0.62398564 -0.55314427
## 124 1.3208296  0.7321411 1.2189235  0.62398564 -0.55314427
## 125 1.3208296  0.7321411 1.2189235  0.62398564 -0.55314427
## 126 1.3208296  0.7321411 1.2189235  0.62398564 -0.55314427
## 127 1.3208296  0.7321411 1.2189235  0.62398564 -0.55314427
## 128 1.3208296  0.7321411 1.2189235  0.62398564 -0.55314427
## 129 1.3208296  0.7321411 1.2189235  0.62398564 -0.55314427
## 130 1.3208296  0.7321411 1.2189235  0.62398564 -0.55314427
## 131 1.3208296  0.7321411 1.2189235  0.62398564 -0.55314427
## 132 1.3208296  0.7321411 1.2189235  0.62398564 -0.55314427
## 133 1.3208296  0.7321411 1.2189235  0.62398564 -0.55314427
## 134 1.3208296  0.7321411 1.2189235  0.62398564 -0.55314427
## 135 1.3208296  0.7321411 1.2189235  0.62398564 -0.55314427
## 136 1.3208296  0.7321411 1.2189235  0.62398564 -0.55314427
## 137 2.2014754  1.9014751 1.8368418  1.73106099 -2.08890342
## 138 2.2014754  1.9014751 1.8368418  1.73106099 -2.08890342
## 139 2.2014754  1.9014751 1.8368418  1.73106099 -2.08890342
## 140 2.2014754  1.9014751 1.8368418  1.73106099 -2.08890342
## 141 2.2014754  1.9014751 1.8368418  1.73106099 -2.08890342
## 142 2.2014754  1.9014751 1.8368418  1.73106099 -2.08890342
## 143 2.2014754  1.9014751 1.8368418  1.73106099 -2.08890342
## 144 2.2014754  1.9014751 1.8368418  1.73106099 -2.08890342
## 145 1.7248030  1.0070459 1.3171687  0.66469738 -0.64120315
## 146 1.7248030  1.0070459 1.3171687  0.66469738 -0.64120315
## 147 1.7248030  1.0070459 1.3171687  0.66469738 -0.64120315
## 148 1.7248030  1.0070459 1.3171687  0.66469738 -0.64120315
## 149 1.7248030  1.0070459 1.3171687  0.66469738 -0.64120315
## 150 1.7248030  1.0070459 1.3171687  0.66469738 -0.64120315
## 151 1.7248030  1.0070459 1.3171687  0.66469738 -0.64120315
## 152 1.7248030  1.0070459 1.3171687  0.66469738 -0.64120315
## 153 1.7248030  1.0070459 1.3171687  0.66469738 -0.64120315
## 154 1.7248030  1.0070459 1.3171687  0.66469738 -0.64120315
## 155 1.7248030  1.0070459 1.3171687  0.66469738 -0.64120315
## 156 1.7248030  1.0070459 1.3171687  0.66469738 -0.64120315
## 157 1.7248030  1.0070459 1.3171687  0.66469738 -0.64120315
## 158 1.7248030  1.0070459 1.3171687  0.66469738 -0.64120315
## 159 1.7248030  1.0070459 1.3171687  0.66469738 -0.64120315
## 160 1.7248030  1.0070459 1.3171687  0.66469738 -0.64120315
## 161 1.7248030  1.0070459 1.3171687  0.66469738 -0.64120315
## 162 1.7248030  1.0070459 1.3171687  0.66469738 -0.64120315
## 163 1.7248030  1.0070459 1.3171687  0.66469738 -0.64120315
## 164 1.7248030  1.0070459 1.3171687  0.66469738 -0.64120315
## 165 1.7248030  1.0070459 1.3171687  0.66469738 -0.64120315
## 166 1.7248030  1.0070459 1.3171687  0.66469738 -0.64120315
## 167 1.7248030  1.0070459 1.3171687  0.66469738 -0.64120315
## 168 1.7248030  1.0070459 1.3171687  0.66469738 -0.64120315
## 169 1.7248030  1.0070459 1.3171687  0.66469738 -0.64120315
## 170 1.7248030  1.0070459 1.3171687  0.66469738 -0.64120315
## 171 1.7248030  1.0070459 1.3171687  0.66469738 -0.64120315
## 172 1.7248030  1.0070459 1.3171687  0.66469738 -0.64120315
## 173 0.8741944 -0.3967143 0.8874432 -0.37066077  0.44763366
## 174 0.8741944 -0.3967143 0.8874432 -0.37066077  0.44763366
## 175 0.8741944 -0.3967143 0.8874432 -0.37066077  0.44763366
## 176 0.8741944 -0.3967143 0.8874432 -0.37066077  0.44763366
## 177 0.8741944 -0.3967143 0.8874432 -0.37066077  0.44763366
## 178 0.8741944 -0.3967143 0.8874432 -0.37066077  0.44763366
## 179 0.8741944 -0.3967143 0.8874432 -0.37066077  0.44763366
## 180 0.7925432 -0.5792464 0.8207813 -0.54337697  0.61448416
## 181 0.7925432 -0.5792464 0.8207813 -0.54337697  0.61448416
## 182 0.7925432 -0.5792464 0.8207813 -0.54337697  0.61448416
## 183 0.7925432 -0.5792464 0.8207813 -0.54337697  0.61448416
## 184 0.7925432 -0.5792464 0.8207813 -0.54337697  0.61448416
## 185 0.7925432 -0.5792464 0.8207813 -0.54337697  0.61448416
## 186 0.7925432 -0.5792464 0.8207813 -0.54337697  0.61448416
## 187 0.7925432 -0.5792464 0.8207813 -0.54337697  0.61448416
## 188 0.7925432 -0.5792464 0.8207813 -0.54337697  0.61448416
## 189 0.7925432 -0.5792464 0.8207813 -0.54337697  0.61448416
## 190 0.7925432 -0.5792464 0.8207813 -0.54337697  0.61448416
## 191 0.7925432 -0.5792464 0.8207813 -0.54337697  0.61448416
## 192 0.7925432 -0.5792464 0.8207813 -0.54337697  0.61448416
## 193 0.7925432 -0.5792464 0.8207813 -0.54337697  0.61448416
## 194 0.7925432 -0.5792464 0.8207813 -0.54337697  0.61448416
## 195 0.7925432 -0.5792464 0.8207813 -0.54337697  0.61448416
## 196 0.7925432 -0.5792464 0.8207813 -0.54337697  0.61448416
## 197 0.7925432 -0.5792464 0.8207813 -0.54337697  0.61448416
## 198 0.7925432 -0.5792464 0.8207813 -0.54337697  0.61448416
## 199 0.7925432 -0.5792464 0.8207813 -0.54337697  0.61448416
## 200 0.7925432 -0.5792464 0.8207813 -0.54337697  0.61448416
##  [ reached 'max' / getOption("max.print") -- omitted 800 rows ]
```


???

Z&lt;sub&gt;h&lt;/sub&gt; &gt; 0 better

infit/outfit, close to 1 is good



---

## If There's a Problem


1. Check S-&amp;chi;&lt;sup&gt;2&lt;/sup&gt;, local dependency
1. Using more complex model types, e.g.,&amp;rarr; 2PL, 3PL;
1. Binary to polytomous or nominal response models
1. Non-parametric smoothing techniques

---

## Cons for Rasch Model

Measurement error

.center[&lt;img src="../courses/governmentalBigData/images/irt_elementarySchool2G.png" height = 450 /&gt;]

???

人们对同一个题理解不同，回答出affirmative答案可能性也不同。

---

## Two-Parameter Logistic Model (2PL IRT)

.center[

**Rasch**: Pr(y&lt;sub&gt;iq&lt;/sub&gt; = 1) = logist&lt;sup&gt;-1&lt;/sup&gt;(&amp;theta;&lt;sub&gt;i&lt;/sub&gt; - &amp;sigma;&lt;sub&gt;q&lt;/sub&gt;)

**2PL**: Pr(y&lt;sub&gt;iq&lt;/sub&gt; = 1) = logist&lt;sup&gt;-1&lt;/sup&gt;(.red[&amp;kappa;&lt;sub&gt;q&lt;/sub&gt;]&amp;theta;&lt;sub&gt;i&lt;/sub&gt; - &amp;sigma;&lt;sub&gt;q&lt;/sub&gt;)

]

&amp;kappa;&lt;sub&gt;q&lt;/sub&gt;: Discrimination (Parameter of dispersion)

???

Discrimination: how well a question can different people from below to above;

Rule of thumb above 1 meaning a good question in terms of examination

--

### Another format

`$$Pr(y_{iq} = 1) = logist^{-1}[\frac{\theta_i - {\color{red}{\beta_q}}}{\color{red}{\alpha_q}}]$$`


&amp;beta;&lt;sub&gt;q&lt;/sub&gt;: &amp;sigma;&lt;sub&gt;q&lt;/sub&gt; &amp;frasl; &amp;kappa;&lt;sub&gt;q&lt;/sub&gt;, threshold("difficulty", location)  
&amp;alpha;&lt;sub&gt;q&lt;/sub&gt;: &amp;kappa;&lt;sub&gt;q&lt;/sub&gt;&lt;sup&gt;-1&lt;/sup&gt;, dispersion (slop)

???

Dispersion: magnitude of the measurement error 

---

.center[&lt;img src="../conference/2021-AsianPoliMeth/images/2pirt.png" height = 600 /&gt;]

???

Difficulty/discrimination: how well a question can different people from below to above

Dispersion: magnitude of the measurement error

---

## Do We Really Need 2PL?


.center[&lt;img src="../courses/governmentalBigData/images/irt_OccamsRazor.gif" height = 100 /&gt;]

--

Likelihood-Ratio Test


```r
anova(m_lsat, m_lsat2PL) %&gt;%  
  select(AIC, SABIC, HQ, logLik, df, p) %&gt;% 
  kable(format = "html")
```

```
## 
## Model 1: mirt(data = df_lsat, model = 1, itemtype = "Rasch", verbose = FALSE)
## Model 2: mirt(data = df_lsat, model = 1, itemtype = "2PL", verbose = FALSE)
```

&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:right;"&gt; AIC &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; SABIC &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; HQ &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; logLik &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; df &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; p &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 5341.802 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 5352.192 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 5352.994 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -2664.901 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; NaN &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; NaN &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 5337.610 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 5354.927 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 5356.263 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -2658.805 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.0159822 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

---

## What If...

.center[&lt;img src="../courses/governmentalBigData/images/irt_purelyGuess.jpg" height = 400 /&gt;]


.center[A lot of .red[low &amp;theta;] respondents]

???

很多人全凭猜怎么办？

---

## Three-Parameter Logistic Model (3PL)

`$$Pr(y_{iq} = 1) = \color{red}{c_i + (1 - c_i)}logist^{-1}[\frac{(\theta_i - \beta_q)}{\alpha_q}]$$`

c&lt;sub&gt;i&lt;/sub&gt;：Item .red[lower] asymptote ("guessing")

--

 Tip: Recommend N &gt; 1,000

???

极大增加演算成本&amp;rarr;通常需要1000以上观测点

---

## What If...

.center[&lt;img src="../courses/governmentalBigData/images/irt_idontcare.gif" height = 400 /&gt;]

---

### Four-Parameter Logistic Model (4PL)

`$$Pr(y_{iq} = 1) = c_i + (\color{red}{d_i} - c_i)logist^{-1}[\frac{(\theta_i - \beta_q)}{\alpha_q}]$$`

d&lt;sub&gt;i&lt;/sub&gt;：Item .red[upper] asymptote ("carelessness"), d &lt; 1

--

 Tip: Considering we already need .red[1,000] for 3PL....

???

鉴于3PL已经需要1000-ish观测点……

---

## Extentions: Unidimentional to Multidimentional

~~Unidimensionality~~


Multidimentional IRT (MIRT, Phil Chalmers, 2015)

`$$Pr(y_{iq} = 1) = logist^{-1}[\frac{\boldsymbol{\theta_i} - \beta_q}{\boldsymbol{\alpha_q}}]$$`


.center[**&amp;theta;&lt;sub&gt;i&lt;/sub&gt;** and **&amp;alpha;&lt;sub&gt;q&lt;/sub&gt;**: Scalar &amp;rarr; Matrix。]

???

Pyschologist


1. Monotonicity
1. Unidimensionality
1. Local independence
1. Parameter invariance

---

## Extension: Binary to Ordinal

Logit &amp;rarr; Cumulative logit

Pr(y&lt;sub&gt;iq&lt;/sub&gt; = 1) &amp;rarr; `\(Pr(\frac{y_{iq}\leq c}{y_{iq}&gt;c})\)`

![](dcpo_files/figure-html/twoDimension-1.png)&lt;!-- --&gt;

---

## Ordinal IRT: Three Oft-Used Modeling

1. (Modified) Graded Response Model (GRM)
    + Better for scoring rubrics, e.g., Likert

--

1. (Generalized) Partial Credit Model (PCM)，Rating Scale Model (RSM)
    + Quit similar to GRM
    + Not require boundary parameters to be ordered
    + Need larger sample size

--

1. Nominal Response Model
    + Better for categorical

???

https://stats.stackexchange.com/questions/402440/how-should-we-select-between-various-item-response-theory-models-e-g-rsm-grm

The rating scale model (RSM) and partial credit model (PCM) are Rasch models. The graded response model (GRM) and the generalized partial credit model are non-Rasch (multinomial).


https://studylib.net/doc/18099752/irt-models-for-polytomous-response-data

---

class: inverse, bottom

# Group IRT

---

## Fixing the Measurement Error Due to the Group Variance

.center[&lt;img src="../courses/governmentalBigData/images/countryBias.png" height = 300 /&gt;]

Multilevel Mixture IRT with Item Bias Effects (Stegmueller 2011)

`$$Pr(y_{iq} = 1) = logist^{-1}[\frac{\theta_i - {\beta_q}}{\color{red}{\alpha_q}}]$$`


Using random effect estimating &amp;alpha;&lt;sub&gt;q&lt;/sub&gt;


???

Daniel Stegmueller, Duke U, poli sci

&amp;alpha;: Dispersion: magnitude of the measurement error 

---

## Finding the Group-Level Latent Variables

Group mean of individual responses

.center[y&lt;sub&gt;kq&lt;/sub&gt; = &amp;Sigma;y&lt;sub&gt;ikq&lt;/sub&gt; &amp;frasl; n.]

--

Aggregation Issues:

1. The mean does not have much substantial influence to the result if the group k is too small.
1. Different ys have different contributions to the latent variable.

???

问题：

1. 如果群组过小，其平均值的代表意义不大
2. 不同的指标对于潜在变量贡献不一样

---

## Getting the Group Mean Right

Multilevel Regression and Post-stratification (MrP)

.red[Predict] a parameter of interest within .red[small domains] through .red[modeling the mean] of the variable of interest .red[conditional on poststratification counts]. 


???

Gelman, Andrew, and Thomas C. Little. 1997. “Poststratification Into Many Categories Using Hierarchical Logistic Regression.” Survey Methods 23: 127--135.


经过群组信息（地理、人口）加权的平均值


--

1. A population is .red[divided] into `H` strata of interest (for example states);
2. The parameters of interest are the .red[means in each strata] &amp;theta;&lt;sub&gt;h&lt;/sub&gt; (h = 1...H);
3. Every stratum is cross-classified by some .red[demographics] j &amp;isin; H, besides every .red[population count] N&lt;sub&gt;j&lt;/sub&gt; is known;
4. All of the population means &amp;mu;&lt;sub&gt;j&lt;/sub&gt; can be estimated by using some statistical technique, such as .red[multilevel regression].

.pull-left[
`$$\theta_h = \frac{\sum_{j \in h} N_j \mu_j }{\sum_{j \in h} N_j}$$`
]
.pull-right[
N: Population of the stratum (Census)
]

???

.Small[
1. 将总体（population）按群组（strata，如国家、地区）切分；
1. 估测对象为核心变量在每个群组中的平均值/比例， &amp;theta;&lt;sub&gt;h&lt;/sub&gt; (h &amp;isin; {1, H});
1. 已知各群组以人口变量j（如老年男性、青年女性等）划分，群组人口（N&lt;sub&gt;j&lt;/sub&gt;）或占总人口比；
1. 各组总体平均值&amp;mu;&lt;sub&gt;j&lt;/sub&gt;可通过multilevel model 进行估算。
]

---

## Example

Source: Economic variables of 2,396 industrial companies in a particular year

Goal: Average income of industries by .red[each of the five existing zones](&amp;theta;&lt;sub&gt;1~5&lt;/sub&gt;). 

Company levels and zones (the population, "company census")

&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt;   &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; A &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; B &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; C &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; D &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; E &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Big &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 30 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 13 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 16 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 23 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Medium &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 180 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 121 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 111 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 187 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 138 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Small &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 97 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 593 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 862 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 20 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

???

https://www.r-bloggers.com/gelmans-mrp-in-r-what-is-this-all-about/


---

Fortunately, we know the .red[true] averages at this time.


&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; Zone &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; income &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; A &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 652.28 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; B &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 320.75 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; C &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 331.02 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; D &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 684.98 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; E &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 767.39 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

---

A random sample of 1,000 from the 2,396 population

&lt;div class="figure" style="text-align: center"&gt;
&lt;img src="dcpo_files/figure-html/rawVsTrue-1.png" alt="Sample Means vs. True Means"  /&gt;
&lt;p class="caption"&gt;Sample Means vs. True Means&lt;/p&gt;
&lt;/div&gt;

---

class: Small

## Step I: Mr

.center[
Income = &amp;beta;&lt;sub&gt;0z&lt;/sub&gt; + &amp;beta;&lt;sub&gt;1z&lt;/sub&gt;Level&lt;sub&gt;iz&lt;/sub&gt; + &amp;epsilon;&lt;sub&gt;iz&lt;/sub&gt;

&amp;beta;&lt;sub&gt;0z&lt;/sub&gt; = &amp;gamma;&lt;sub&gt;00&lt;/sub&gt; + &amp;gamma;&lt;sub&gt;01&lt;/sub&gt;Zone&lt;sub&gt;z&lt;/sub&gt; + u&lt;sub&gt;0z&lt;/sub&gt;]

--

Output: Post-strata means


```r
# Step 1: &lt;&lt;MR&gt;&gt; - Multilevel regression
M1 &lt;- lmer(Income ~ Level + (1 | Zone), data = SLucy)
SLucy$Pred &lt;- predict(M1)

# Summary
sum &lt;- group_by(SLucy, Zone, Level) %&gt;% 
  summarise(mean2 = mean(Pred))
Mupred &lt;- matrix(sum$mean2, ncol = 5, nrow = 3)

rownames(Mupred) &lt;- levels(SLucy$Level)
colnames(Mupred) &lt;- levels(SLucy$Zone)

Mupred %&gt;% kable(format = "html", digits = 2)
```

&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt;   &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; A &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; B &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; C &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; D &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; E &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Big &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1274.74 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1148.58 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1189.59 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1238.51 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1251.95 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Medium &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 706.19 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 580.03 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 621.03 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 669.96 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 683.40 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Small &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 372.95 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 246.79 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 287.79 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 336.72 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 350.16 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

---

## Step II: P

N&lt;sub&gt;z&lt;/sub&gt; &amp;times; weighted mean / N&lt;sub&gt;z&lt;/sub&gt;


```r
colSums(Np * Mupred) / count(Lucy, Zone)$n
```

```
##        A        B        C        D        E 
## 656.4551 318.3753 326.6951 680.8675 754.5761
```

---

## Comparision

&lt;img src="dcpo_files/figure-html/mrpVsraw-1.png" style="display: block; margin: auto;" /&gt;

---

## What MrP Can't Solve

+ Question uniqueness &amp;times; Zones
+ Scale of questions
+ Measurement Error
+ Time trend

--

After, all, MrP is still a mean measurement of the latent variable.

--

### Solution

Dynamic Group-level IRT (DGIRT, Caughey &amp; Warshaw 2015)

???

Combining IRT and MrP plus dynamic element

---

## DGIRT

1. Estimate IRT within each group;    
&amp;rarr; .red[Latent variable] in
1. Embed the group IRT in a multilevel framework;    
&amp;rarr; .red[Group] in
1. Allowing hierarchical parameters to evolve according to a dynamic model;    
&amp;rarr; .red[Time] in
1. Weight the estimates with for groups.    
&amp;rarr; .red[MrP] in


---

## Latent Variable Estimates at the Group Level

Individual

`$$p_{iq} = logist^{-1}[\frac{\theta_i - {\beta_q}}{\alpha_q}]$$`

--

Group     
(k &amp;isin; {1...K})

`$$\eta_{ktq} = logit^{-1}(\frac{\color{red}{\bar{\theta}_{kt}}- \beta_q}{\sqrt{\alpha^2_q + \color{red}{(1.7\sigma_{kt})^2}}}).$$`

.center[
`\(\bar{\theta}_kt\)` and &amp;sigma;&lt;sub&gt;kt&lt;/sub&gt; is the mean and SD the latent variable in Group `k` at time `t`.
]

???

1.7: sd of probit is (&amp;pi;/3)&lt;sup&gt;1/2&lt;/sup&gt; for logit, while Long 1997 found it is more close to 1.7 in actual estimations.

Mislevy, Robert J. 1983. “Item Response Models for Grouped Data.” Journal of Educational Statistics 8(4): 271–88.

&amp;eta;: eta 

---

## Modeling Time and Space

`$$\bar{\theta}_k\sim N(\xi_t + \boldsymbol{x'_k\gamma}, \sigma^2_{\bar{\theta}})$$`

.center[&amp;xi;&lt;sub&gt;t&lt;/sub&gt; ~ N(&amp;xi;&lt;sub&gt;.red[t-1]&lt;/sub&gt;;&amp;sigma;&lt;sub&gt;&amp;gamma;&lt;/sub&gt;&lt;sup&gt;2&lt;/sup&gt;)]

.center[&amp;gamma;&lt;sub&gt;pt&lt;/sub&gt; ~ N(&amp;gamma;&lt;sub&gt;p,t-1&lt;/sub&gt;&amp;delta;&lt;sub&gt;t&lt;/sub&gt; + .red[**z'&lt;sub&gt;p.&lt;/sub&gt;&amp;eta;&lt;sub&gt;t&lt;/sub&gt;**], &amp;sigma;&lt;sub&gt;&amp;gamma;&lt;/sub&gt;&lt;sup&gt;2&lt;/sup&gt;)]

.center[n&lt;sup&gt;*&lt;/sup&gt;&lt;sub&gt;kqt&lt;/sub&gt;]

???
 
&amp;xi;&lt;sub&gt;t&lt;/sub&gt;: xi

x 为群组级变量  
t-1, dynamic linear model  
**z'&lt;sub&gt;p.&lt;/sub&gt;&amp;eta;&lt;sub&gt;t&lt;/sub&gt;**: geography-level attributes, &amp;eta;是coefficients  
n&lt;sup&gt;*&lt;/sup&gt;&lt;sub&gt;kqt&lt;/sub&gt;基于MrP

---

.pull-left[
### Pros

+ Including time, space, and questions
+ Increasing representativeness
]

--

.pull-right[
### Cons

+ Complicated
    + In weeks
]

???

Caughey &amp; Warshaw称会跑几个星期

--

### Simpler DGIRT (Claassen 2019)

Simplified 1. Only at the state level   
Simplified 2. From estimating &amp;alpha; (dispersion) to &amp;beta; (difficulty)  
Simplified 3. Ignoring polarization.


???

&amp;delta;&lt;sub&gt;kq&lt;/sub&gt;: 问题的difficulty随国家k变化。

---

## The Newest Development in Group IRT: DCPO

.pull-left[
.red[D]ynamic .red[C]omparative .red[P]ublic .red[O]pinion (Bayesian-Based)

### Complexity 

Claasseen 2019 &lt; DCPO &lt; DGIRT

]

.pull-right[
&lt;img src="../courses/governmentalBigData/images/fsolt.jpeg" height = 350 /&gt;

Frederick Solt (University of Iowa)
]

---


## DCPO

`$$Pr(y_{ktqr} = 1) = logist^{-1}[\frac{\bar{\theta}'_{kt} - {(\beta_{qr} + \color{orange}{\delta_{kq}})}}{\sqrt{\alpha^2_q + (1.7\times \color{red}{\sigma_{kt}})^2}}]$$`


.pull-left[
`\(\bar{\theta}\)`: Mean public opinion    
&amp;beta;: Question difficulty   
&amp;alpha;: Question dispersion
]

.pull-right[
.orange[&amp;delta;]: Country-specific item bias   
.red[&amp;sigma;:] Polarization in public opinion]

--

.green[Random walk priors] for opinion mean and sd

`$$\bar{\theta}_{ktqr}\sim N(\bar{\theta}'_{k, \color{green}{t-1}}, \sigma^2_{\bar{\theta}'}),\sigma_{kt}\sim LN(\sigma_{k, \color{green}{t-1}}, \sigma^2_{\sigma})$$`

???
D(dynamic)C(comparative)PO
model country specific-item to address equivalence. 
aggregate level public opinion 
polarizaiton 
ordinal scaled answers. 
The sophisticated measurement models ignite the hope on the studies of relationship between democratic development and public support. 

Claassen, Christopher. 2019. “Estimating Smooth Country–Year Panels of Public Opinion.” *Political Analysis* 27(1):1–20

Caughey, Devin, Tom O’Grady and Christopher Warshaw. 2019. “Policy Ideology in European
Mass Publics, 1981–2016.” American Political Science Review 113(3):674–693

Solt, Frederick. 2020b. “Modeling Dynamic Comparative Public Opinion.” SocArXiv
10.31235/osf.io/d5n9p.


---

background-image: url("../courses/governmentalBigData/images/irtCompare.png")
background-position: center
background-size: contain


???

Bounded: 使用logit归为0-1

---

## Validations

.center[&lt;img src="../courses/governmentalBigData/images/irtFitCompare.png" height = 300 /&gt;]

---

## Operation

1. Collect survey data and identify the survey items;
1. Generate raw dataset (using `DCPOtools`);
1. Reformat dataset for model (using `DCPOtools`);
1. Analyze the data with `DCPO`
1. Diagnosis for convergence with `shinystan`.


---

class: middle, center

## One More Thing, An .red[Important] Thing!

No uncertainty engaged &amp;hArr; The latent variable is measured .red["perfectly"].

&amp;dArr; 

Biased coefficients and standard errors.


--

.bg-black.golden.ba.shadow-5.ph4.mt3.center[
Uncertainty Matters!
]

---

### How?

Overimputations (Alternative: model of compositions)

1. .red[Repeated] Latent variable estimation (e.g., DCPO &amp;times; 1000);
1. Regressing with the .red[distribution];
1. .red[Combination] with Rubin's Rule.

???

Blackwell, Matthew, James Honaker, and Gary King. 2017. “A Unified Approach to Measurement Error and Missing Data: Overview.” Sociological Methods &amp; Research: 303–41.


---

## Going Against the Most Recent Findings 

Claassen 2020 AJPS; Claassen 2020 APSR

.pull-left[&lt;img src="../courses/governmentalBigData/images/irt_idontcare.gif" height = 400 /&gt;]

--

.pull-right[
### More Data together with Better Method

1988~2020 (144 countries, 33 years)

Comparing with Claassen (2020a, 2020b):

&gt; 26.2% .red[more] questions;     
33.3% .red[more] survey sources
]

---

background-image: url("../conference/2021-AsianPoliMeth/images/visualizeAJPS-1.png")
background-position: center
background-size: contain

## Findings

---

background-image: url("../conference/2021-AsianPoliMeth/images/visualizedAPSR-1.png")
background-position: center
background-size: contain

---

## Potential Explanations

.pull-left[
### Methodology

1. .red[Multidimensional] support;
1. Conceptual .red[Difference];
1. Relations with .red[other values].

]

???

survey questions do not ask respondents how they prioritize democracy relative to other values with which it may come into conflict, such as their partisanship.cannot capture the extent

--

.pull-right[
### Theory

1. Effectiveness .red[&gt;] existence
1. Support + .red[dissatisfaction]
1. .red[Elite] driven

]

???

It's is the combination of democratic support and dissatisfaction with current regime performance that generates demand for greater democracy

Qi, Lingling and Doh Chull Shin. 2011. “How Mass Political Attitudes Affect Democratization: Exploring the Facilitating Role Critical Democrats Play in the Process.” *International Political Science Review* 32(3):245–262

---

## Take-Home Points

1. Rethinking Democracy &amp;harr; Public support: .red[~~Sanguine~~] assessment
1. Cross-section time-series diverse-question method: .blue[DCPO]
    + `DCPO`
    + `DCPOtools`
    
&lt;iframe src="https://ctai.shinyapps.io/dmsweb/" height = 300 width = 1000&gt;&lt;/iframe&gt;
    

???
Uncertainty caused by measurement and in concept. 
without taking uncertainty into account, no way of knowing whether their conclusions are correct or not even their studies have been published in top journals. 

Sanguine, super optimistic fate of democracies rely on their public, but is not well grounded. 
practioners and researchers interested in democracy and understanding democracies should work hard to figour out what is going one. 
we point several potential explanations, but we dont' know which one is right. each of them is worth additional research. 

---

class: inverse, center, middle

# Thank you!

&lt;svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="height:1em;position:relative;display:inline-block;top:.1em;" xmlns="http://www.w3.org/2000/svg"&gt;  &lt;path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"&gt;&lt;/path&gt;  &lt;polyline points="22,6 12,13 2,6"&gt;&lt;/polyline&gt;&lt;/svg&gt;&amp;nbsp;[yuehu@tsinghua.edu.cn](mailto:yuehu@tsinghua.edu.cn) 

&lt;svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="height:1em;position:relative;display:inline-block;top:.1em;" xmlns="http://www.w3.org/2000/svg"&gt;  &lt;circle cx="12" cy="12" r="10"&gt;&lt;/circle&gt;  &lt;line x1="2" y1="12" x2="22" y2="12"&gt;&lt;/line&gt;  &lt;path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"&gt;&lt;/path&gt;&lt;/svg&gt;&amp;nbsp; https://sammo3182.github.io/

&lt;svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="height:1em;position:relative;display:inline-block;top:.1em;" xmlns="http://www.w3.org/2000/svg"&gt;  &lt;path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"&gt;&lt;/path&gt;&lt;/svg&gt;&amp;nbsp; [sammo3182](https://github.com/sammo3182)
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="libs/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"highlightSpans": true,
"countIncrementalSlides": false,
"ratio": "16:9"
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_HTMLorMML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
